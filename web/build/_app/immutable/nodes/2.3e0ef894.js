import{s as me,n as se,r as De,f as ye,o as Fe,b as ze,h as We}from"../chunks/scheduler.89bf212d.js";import{S as _e,i as pe,g as I,m as X,s as H,h as L,j as A,n as x,f as S,c as B,k,a as P,x as D,y as Q,l as Se,e as de,o as fe,r as ae,u as oe,v as ie,d as W,p as ke,b as $e,t as Z,z as Ye,w as ce,A as he,B as Je}from"../chunks/index.2f508abb.js";function Te(o){return(o==null?void 0:o.length)!==void 0?o:Array.from(o)}function qe(o){let e,t,r,l,n,s,c,a,i,m;return{c(){e=I("div"),t=I("button"),r=X("Outputs"),n=H(),s=I("button"),c=X("Collections"),this.h()},l(f){e=L(f,"DIV",{role:!0,class:!0});var M=A(e);t=L(M,"BUTTON",{role:!0,class:!0});var _=A(t);r=x(_,"Outputs"),_.forEach(S),n=B(M),s=L(M,"BUTTON",{role:!0,class:!0});var w=A(s);c=x(w,"Collections"),w.forEach(S),M.forEach(S),this.h()},h(){k(t,"role","tab"),k(t,"class",l="tab "+o[0]("outputs")),k(s,"role","tab"),k(s,"class",a="tab "+o[0]("collections")),k(e,"role","tablist"),k(e,"class","tabs tabs-boxed")},m(f,M){P(f,e,M),D(e,t),D(t,r),D(e,n),D(e,s),D(s,c),i||(m=[Q(t,"click",o[3]),Q(s,"click",o[4])],i=!0)},p(f,[M]){M&1&&l!==(l="tab "+f[0]("outputs"))&&k(t,"class",l),M&1&&a!==(a="tab "+f[0]("collections"))&&k(s,"class",a)},i:se,o:se,d(f){f&&S(e),i=!1,De(m)}}}function Ze(o,e,t){let r,{activeTab:l="outputs"}=e;function n(a){t(2,l=a)}const s=()=>n("outputs"),c=()=>n("collections");return o.$$set=a=>{"activeTab"in a&&t(2,l=a.activeTab)},o.$$.update=()=>{o.$$.dirty&4&&t(0,r=function(a){return a===l?"tab-active":""})},[r,n,l,s,c]}class Re extends _e{constructor(e){super(),pe(this,e,Ze,qe,me,{activeTab:2})}}var Ge=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Ke(o){return o&&o.__esModule&&Object.prototype.hasOwnProperty.call(o,"default")?o.default:o}var Ae={exports:{}};(function(o,e){(function(t,r){o.exports=r()})(Ge,function(){var t=1e3,r=6e4,l=36e5,n="millisecond",s="second",c="minute",a="hour",i="day",m="week",f="month",M="quarter",_="year",w="date",U="Invalid Date",O=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,V=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,F={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(y){var d=["th","st","nd","rd"],h=y%100;return"["+y+(d[(h-20)%10]||d[h]||d[0])+"]"}},v=function(y,d,h){var b=String(y);return!b||b.length>=d?y:""+Array(d+1-b.length).join(h)+y},$={s:v,z:function(y){var d=-y.utcOffset(),h=Math.abs(d),b=Math.floor(h/60),u=h%60;return(d<=0?"+":"-")+v(b,2,"0")+":"+v(u,2,"0")},m:function y(d,h){if(d.date()<h.date())return-y(h,d);var b=12*(h.year()-d.year())+(h.month()-d.month()),u=d.clone().add(b,f),p=h-u<0,g=d.clone().add(b+(p?-1:1),f);return+(-(b+(h-u)/(p?u-g:g-u))||0)},a:function(y){return y<0?Math.ceil(y)||0:Math.floor(y)},p:function(y){return{M:f,y:_,w:m,d:i,D:w,h:a,m:c,s,ms:n,Q:M}[y]||String(y||"").toLowerCase().replace(/s$/,"")},u:function(y){return y===void 0}},T="en",N={};N[T]=F;var ee="$isDayjsObject",K=function(y){return y instanceof te||!(!y||!y[ee])},J=function y(d,h,b){var u;if(!d)return T;if(typeof d=="string"){var p=d.toLowerCase();N[p]&&(u=p),h&&(N[p]=h,u=p);var g=d.split("-");if(!u&&g.length>1)return y(g[0])}else{var E=d.name;N[E]=d,u=E}return!b&&u&&(T=u),u||!b&&T},Y=function(y,d){if(K(y))return y.clone();var h=typeof d=="object"?d:{};return h.date=y,h.args=arguments,new te(h)},C=$;C.l=J,C.i=K,C.w=function(y,d){return Y(y,{locale:d.$L,utc:d.$u,x:d.$x,$offset:d.$offset})};var te=function(){function y(h){this.$L=J(h.locale,null,!0),this.parse(h),this.$x=this.$x||h.x||{},this[ee]=!0}var d=y.prototype;return d.parse=function(h){this.$d=function(b){var u=b.date,p=b.utc;if(u===null)return new Date(NaN);if(C.u(u))return new Date;if(u instanceof Date)return new Date(u);if(typeof u=="string"&&!/Z$/i.test(u)){var g=u.match(O);if(g){var E=g[2]-1||0,j=(g[7]||"0").substring(0,3);return p?new Date(Date.UTC(g[1],E,g[3]||1,g[4]||0,g[5]||0,g[6]||0,j)):new Date(g[1],E,g[3]||1,g[4]||0,g[5]||0,g[6]||0,j)}}return new Date(u)}(h),this.init()},d.init=function(){var h=this.$d;this.$y=h.getFullYear(),this.$M=h.getMonth(),this.$D=h.getDate(),this.$W=h.getDay(),this.$H=h.getHours(),this.$m=h.getMinutes(),this.$s=h.getSeconds(),this.$ms=h.getMilliseconds()},d.$utils=function(){return C},d.isValid=function(){return this.$d.toString()!==U},d.isSame=function(h,b){var u=Y(h);return this.startOf(b)<=u&&u<=this.endOf(b)},d.isAfter=function(h,b){return Y(h)<this.startOf(b)},d.isBefore=function(h,b){return this.endOf(b)<Y(h)},d.$g=function(h,b,u){return C.u(h)?this[b]:this.set(u,h)},d.unix=function(){return Math.floor(this.valueOf()/1e3)},d.valueOf=function(){return this.$d.getTime()},d.startOf=function(h,b){var u=this,p=!!C.u(b)||b,g=C.p(h),E=function(le,R){var ne=C.w(u.$u?Date.UTC(u.$y,R,le):new Date(u.$y,R,le),u);return p?ne:ne.endOf(i)},j=function(le,R){return C.w(u.toDate()[le].apply(u.toDate("s"),(p?[0,0,0,0]:[23,59,59,999]).slice(R)),u)},z=this.$W,q=this.$M,G=this.$D,ue="set"+(this.$u?"UTC":"");switch(g){case _:return p?E(1,0):E(31,11);case f:return p?E(1,q):E(0,q+1);case m:var re=this.$locale().weekStart||0,ve=(z<re?z+7:z)-re;return E(p?G-ve:G+(6-ve),q);case i:case w:return j(ue+"Hours",0);case a:return j(ue+"Minutes",1);case c:return j(ue+"Seconds",2);case s:return j(ue+"Milliseconds",3);default:return this.clone()}},d.endOf=function(h){return this.startOf(h,!1)},d.$set=function(h,b){var u,p=C.p(h),g="set"+(this.$u?"UTC":""),E=(u={},u[i]=g+"Date",u[w]=g+"Date",u[f]=g+"Month",u[_]=g+"FullYear",u[a]=g+"Hours",u[c]=g+"Minutes",u[s]=g+"Seconds",u[n]=g+"Milliseconds",u)[p],j=p===i?this.$D+(b-this.$W):b;if(p===f||p===_){var z=this.clone().set(w,1);z.$d[E](j),z.init(),this.$d=z.set(w,Math.min(this.$D,z.daysInMonth())).$d}else E&&this.$d[E](j);return this.init(),this},d.set=function(h,b){return this.clone().$set(h,b)},d.get=function(h){return this[C.p(h)]()},d.add=function(h,b){var u,p=this;h=Number(h);var g=C.p(b),E=function(q){var G=Y(p);return C.w(G.date(G.date()+Math.round(q*h)),p)};if(g===f)return this.set(f,this.$M+h);if(g===_)return this.set(_,this.$y+h);if(g===i)return E(1);if(g===m)return E(7);var j=(u={},u[c]=r,u[a]=l,u[s]=t,u)[g]||1,z=this.$d.getTime()+h*j;return C.w(z,this)},d.subtract=function(h,b){return this.add(-1*h,b)},d.format=function(h){var b=this,u=this.$locale();if(!this.isValid())return u.invalidDate||U;var p=h||"YYYY-MM-DDTHH:mm:ssZ",g=C.z(this),E=this.$H,j=this.$m,z=this.$M,q=u.weekdays,G=u.months,ue=u.meridiem,re=function(R,ne,ge,we){return R&&(R[ne]||R(b,p))||ge[ne].slice(0,we)},ve=function(R){return C.s(E%12||12,R,"0")},le=ue||function(R,ne,ge){var we=R<12?"AM":"PM";return ge?we.toLowerCase():we};return p.replace(V,function(R,ne){return ne||function(ge){switch(ge){case"YY":return String(b.$y).slice(-2);case"YYYY":return C.s(b.$y,4,"0");case"M":return z+1;case"MM":return C.s(z+1,2,"0");case"MMM":return re(u.monthsShort,z,G,3);case"MMMM":return re(G,z);case"D":return b.$D;case"DD":return C.s(b.$D,2,"0");case"d":return String(b.$W);case"dd":return re(u.weekdaysMin,b.$W,q,2);case"ddd":return re(u.weekdaysShort,b.$W,q,3);case"dddd":return q[b.$W];case"H":return String(E);case"HH":return C.s(E,2,"0");case"h":return ve(1);case"hh":return ve(2);case"a":return le(E,j,!0);case"A":return le(E,j,!1);case"m":return String(j);case"mm":return C.s(j,2,"0");case"s":return String(b.$s);case"ss":return C.s(b.$s,2,"0");case"SSS":return C.s(b.$ms,3,"0");case"Z":return g}return null}(R)||g.replace(":","")})},d.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},d.diff=function(h,b,u){var p,g=this,E=C.p(b),j=Y(h),z=(j.utcOffset()-this.utcOffset())*r,q=this-j,G=function(){return C.m(g,j)};switch(E){case _:p=G()/12;break;case f:p=G();break;case M:p=G()/3;break;case m:p=(q-z)/6048e5;break;case i:p=(q-z)/864e5;break;case a:p=q/l;break;case c:p=q/r;break;case s:p=q/t;break;default:p=q}return u?p:C.a(p)},d.daysInMonth=function(){return this.endOf(f).$D},d.$locale=function(){return N[this.$L]},d.locale=function(h,b){if(!h)return this.$L;var u=this.clone(),p=J(h,b,!0);return p&&(u.$L=p),u},d.clone=function(){return C.w(this.$d,this)},d.toDate=function(){return new Date(this.valueOf())},d.toJSON=function(){return this.isValid()?this.toISOString():null},d.toISOString=function(){return this.$d.toISOString()},d.toString=function(){return this.$d.toUTCString()},y}(),be=te.prototype;return Y.prototype=be,[["$ms",n],["$s",s],["$m",c],["$H",a],["$W",i],["$M",f],["$y",_],["$D",w]].forEach(function(y){be[y[1]]=function(d){return this.$g(d,y[0],y[1])}}),Y.extend=function(y,d){return y.$i||(y(d,te,Y),y.$i=!0),Y},Y.locale=J,Y.isDayjs=K,Y.unix=function(y){return Y(1e3*y)},Y.en=N[T],Y.Ls=N,Y.p={},Y})})(Ae);var Qe=Ae.exports;const Xe=Ke(Qe);async function Pe(o,e){let l=(await(await fetch(e+"/browser/"+o)).json()).files;return l.forEach(n=>{const s=n.name.split(".").pop().toLowerCase();n.fileType="unknown",["png","webp","jpeg","jpg","gif"].includes(s)&&(n.fileType="image"),["mp4","webm","mov","avi","mkv"].includes(s)&&(n.fileType="video"),o==="collections"?n.url=`${e}/browser/collections/view?filename=${n.name}`:n.url=`${e}/view?filename=${n.name}`;const c=Xe.unix(n.created_at);n.formattedDatetime=c.format("YYYY-MM-DD HH-mm-ss"),n.bytes/1024/1024>1?n.formattedSize=(n.bytes/1024/1024).toFixed(2)+" MB":n.formattedSize=Math.round(n.bytes/1024)+" KB"}),l}function He(o,e){if(o>=e)return o;const t=document.documentElement.scrollHeight;return window.innerHeight+window.scrollY>=t?o+10:o}function Me(o){let e,t,r;return{c(){e=I("img"),this.h()},l(l){e=L(l,"IMG",{class:!0,src:!0,alt:!0}),this.h()},h(){k(e,"class",""),ye(e.src,t=o[0].url)||k(e,"src",t),k(e,"alt",r=o[0].name)},m(l,n){P(l,e,n)},p(l,n){n&1&&!ye(e.src,t=l[0].url)&&k(e,"src",t),n&1&&r!==(r=l[0].name)&&k(e,"alt",r)},d(l){l&&S(e)}}}function Ce(o){let e,t,r;return{c(){e=I("video"),t=I("track"),this.h()},l(l){e=L(l,"VIDEO",{class:!0,src:!0});var n=A(e);t=L(n,"TRACK",{kind:!0}),n.forEach(S),this.h()},h(){k(t,"kind","captions"),k(e,"class","object-contain pb-0.5 border-0.5 border-black"),ye(e.src,r=o[0].url)||k(e,"src",r),e.loop=!0,e.autoplay=!0,e.muted=!0},m(l,n){P(l,e,n),D(e,t)},p(l,n){n&1&&!ye(e.src,r=l[0].url)&&k(e,"src",r)},d(l){l&&S(e)}}}function xe(o){let e,t,r,l,n=o[0].fileType==="image"&&Me(o),s=o[0].fileType==="video"&&Ce(o);return{c(){e=I("div"),t=I("a"),n&&n.c(),r=H(),s&&s.c(),this.h()},l(c){e=L(c,"DIV",{class:!0});var a=A(e);t=L(a,"A",{href:!0,target:!0,style:!0});var i=A(t);n&&n.l(i),r=B(i),s&&s.l(i),i.forEach(S),a.forEach(S),this.h()},h(){k(t,"href",l=o[0].url),k(t,"target","_blank"),Se(t,"max-height","inherit"),Se(t,"max-width","inherit"),k(e,"class",o[1])},m(c,a){P(c,e,a),D(e,t),n&&n.m(t,null),D(t,r),s&&s.m(t,null)},p(c,[a]){c[0].fileType==="image"?n?n.p(c,a):(n=Me(c),n.c(),n.m(t,r)):n&&(n.d(1),n=null),c[0].fileType==="video"?s?s.p(c,a):(s=Ce(c),s.c(),s.m(t,null)):s&&(s.d(1),s=null),a&1&&l!==(l=c[0].url)&&k(t,"href",l),a&2&&k(e,"class",c[1])},i:se,o:se,d(c){c&&S(e),n&&n.d(),s&&s.d()}}}function et(o,e,t){let{file:r}=e,{styleClass:l}=e;return o.$$set=n=>{"file"in n&&t(0,r=n.file),"styleClass"in n&&t(1,l=n.styleClass)},[r,l]}class Be extends _e{constructor(e){super(),pe(this,e,et,xe,me,{file:0,styleClass:1})}}function Oe(o){let e,t,r,l,n;return{c(){e=I("div"),t=I("div"),r=I("span"),l=X(o[2]),this.h()},l(s){e=L(s,"DIV",{class:!0});var c=A(e);t=L(c,"DIV",{class:!0});var a=A(t);r=L(a,"SPAN",{});var i=A(r);l=x(i,o[2]),i.forEach(S),a.forEach(S),c.forEach(S),this.h()},h(){k(t,"class",n="alert alert-"+(o[1]?"success":"error")),k(e,"class","toast toast-center")},m(s,c){P(s,e,c),D(e,t),D(t,r),D(r,l)},p(s,c){c&4&&fe(l,s[2]),c&2&&n!==(n="alert alert-"+(s[1]?"success":"error"))&&k(t,"class",n)},d(s){s&&S(e)}}}function tt(o){let e,t=o[0]&&Oe(o);return{c(){t&&t.c(),e=de()},l(r){t&&t.l(r),e=de()},m(r,l){t&&t.m(r,l),P(r,e,l)},p(r,[l]){r[0]?t?t.p(r,l):(t=Oe(r),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},i:se,o:se,d(r){r&&S(e),t&&t.d(r)}}}function nt(o,e,t){let{showToast:r=!1}=e,{toastSuccess:l=!0}=e,{toastText:n=""}=e;return o.$$set=s=>{"showToast"in s&&t(0,r=s.showToast),"toastSuccess"in s&&t(1,l=s.toastSuccess),"toastText"in s&&t(2,n=s.toastText)},[r,l,n]}class Ve extends _e{constructor(e){super(),pe(this,e,nt,tt,me,{showToast:0,toastSuccess:1,toastText:2})}}function Ee(o,e,t){const r=o.slice();return r[13]=e[t],r}function Ue(o){let e,t,r,l,n,s=o[13].name+"",c,a,i,m=o[13].formattedDatetime+"",f,M,_,w=o[13].formattedSize+"",U,O,V,F;r=new Be({props:{file:o[13],styleClass:""}});let v=o[0]&&Ie(o);return{c(){e=I("div"),t=I("div"),ae(r.$$.fragment),l=H(),n=I("p"),c=X(s),a=H(),i=I("p"),f=X(m),M=H(),_=I("p"),U=X(w),O=H(),v&&v.c(),V=H(),this.h()},l($){e=L($,"DIV",{class:!0});var T=A(e);t=L(T,"DIV",{class:!0});var N=A(t);oe(r.$$.fragment,N),N.forEach(S),l=B(T),n=L(T,"P",{});var ee=A(n);c=x(ee,s),ee.forEach(S),a=B(T),i=L(T,"P",{});var K=A(i);f=x(K,m),K.forEach(S),M=B(T),_=L(T,"P",{});var J=A(_);U=x(J,w),J.forEach(S),O=B(T),v&&v.l(T),V=B(T),T.forEach(S),this.h()},h(){k(t,"class","flex items-center"),k(e,"class","browser-item svelte-73vnv2")},m($,T){P($,e,T),D(e,t),ie(r,t,null),D(e,l),D(e,n),D(n,c),D(e,a),D(e,i),D(i,f),D(e,M),D(e,_),D(_,U),D(e,O),v&&v.m(e,null),D(e,V),F=!0},p($,T){const N={};T&6&&(N.file=$[13]),r.$set(N),(!F||T&6)&&s!==(s=$[13].name+"")&&fe(c,s),(!F||T&6)&&m!==(m=$[13].formattedDatetime+"")&&fe(f,m),(!F||T&6)&&w!==(w=$[13].formattedSize+"")&&fe(U,w),$[0]?v?v.p($,T):(v=Ie($),v.c(),v.m(e,V)):v&&(v.d(1),v=null)},i($){F||(W(r.$$.fragment,$),F=!0)},o($){Z(r.$$.fragment,$),F=!1},d($){$&&S(e),ce(r),v&&v.d()}}}function Ie(o){let e,t="Load",r,l,n="Collect",s,c,a="Delete",i,m;function f(){return o[10](o[13])}function M(){return o[11](o[13])}function _(){return o[12](o[13])}return{c(){e=I("button"),e.textContent=t,r=H(),l=I("button"),l.textContent=n,s=H(),c=I("button"),c.textContent=a,this.h()},l(w){e=L(w,"BUTTON",{class:!0,"data-svelte-h":!0}),he(e)!=="svelte-ctmpgz"&&(e.textContent=t),r=B(w),l=L(w,"BUTTON",{class:!0,"data-svelte-h":!0}),he(l)!=="svelte-bp09qj"&&(l.textContent=n),s=B(w),c=L(w,"BUTTON",{class:!0,"data-svelte-h":!0}),he(c)!=="svelte-7ie4ox"&&(c.textContent=a),this.h()},h(){k(e,"class","btn btn-ghost"),k(l,"class","btn btn-ghost"),k(c,"class","btn btn-ghost")},m(w,U){P(w,e,U),P(w,r,U),P(w,l,U),P(w,s,U),P(w,c,U),i||(m=[Q(e,"click",f),Q(l,"click",M),Q(c,"click",_)],i=!0)},p(w,U){o=w},d(w){w&&(S(e),S(r),S(l),S(s),S(c)),i=!1,De(m)}}}function Le(o){let e=["image","video"].includes(o[13].fileType),t,r,l=e&&Ue(o);return{c(){l&&l.c(),t=de()},l(n){l&&l.l(n),t=de()},m(n,s){l&&l.m(n,s),P(n,t,s),r=!0},p(n,s){s&6&&(e=["image","video"].includes(n[13].fileType)),e?l?(l.p(n,s),s&6&&W(l,1)):(l=Ue(n),l.c(),W(l,1),l.m(t.parentNode,t)):l&&(ke(),Z(l,1,1,()=>{l=null}),$e())},i(n){r||(W(l),r=!0)},o(n){Z(l),r=!1},d(n){n&&S(t),l&&l.d(n)}}}function st(o){let e,t,r,l,n=Te(o[1].slice(0,o[2])),s=[];for(let a=0;a<n.length;a+=1)s[a]=Le(Ee(o,n,a));const c=a=>Z(s[a],1,1,()=>{s[a]=null});return r=new Ve({props:{showToast:o[3],toastSuccess:o[4],toastText:o[5]}}),{c(){e=I("div");for(let a=0;a<s.length;a+=1)s[a].c();t=H(),ae(r.$$.fragment),this.h()},l(a){e=L(a,"DIV",{class:!0});var i=A(e);for(let m=0;m<s.length;m+=1)s[m].l(i);i.forEach(S),t=B(a),oe(r.$$.fragment,a),this.h()},h(){k(e,"class","grid grid-cols-4 lg:grid-cols-6 gap-2")},m(a,i){P(a,e,i);for(let m=0;m<s.length;m+=1)s[m]&&s[m].m(e,null);P(a,t,i),ie(r,a,i),l=!0},p(a,[i]){if(i&455){n=Te(a[1].slice(0,a[2]));let f;for(f=0;f<n.length;f+=1){const M=Ee(a,n,f);s[f]?(s[f].p(M,i),W(s[f],1)):(s[f]=Le(M),s[f].c(),W(s[f],1),s[f].m(e,null))}for(ke(),f=n.length;f<s.length;f+=1)c(f);$e()}const m={};i&8&&(m.showToast=a[3]),i&16&&(m.toastSuccess=a[4]),i&32&&(m.toastText=a[5]),r.$set(m)},i(a){if(!l){for(let i=0;i<n.length;i+=1)W(s[i]);W(r.$$.fragment,a),l=!0}},o(a){s=s.filter(Boolean);for(let i=0;i<s.length;i+=1)Z(s[i]);Z(r.$$.fragment,a),l=!1},d(a){a&&(S(e),S(t)),Ye(s,a),ce(r,a)}}}function rt(o,e,t){let{comfyUrl:r}=e,l,n=[],s=20,c=!1,a=!0,i="";Fe(async()=>{t(0,l=window.top.comfyApp||r),t(1,n=await Pe("files",r)),window.addEventListener("scroll",()=>{t(2,s=He(s,n.length))})});async function m(O){const V=await fetch(O.url),F=await V.blob(),v=new File([F],O.name,{type:V.headers.get("Content-Type")||""});await l.handleFile(v)}async function f(O){const V=await fetch(r+"/browser/collections",{method:"POST",body:JSON.stringify({filename:O.name,folder_path:O.folder_path})});t(4,a=V.ok),a?t(5,i="Added to collections"):t(5,i="Failed to add to collections. Please check the ComfyUI server."),t(3,c=!0),setTimeout(()=>t(3,c=!1),2e3)}async function M(O){if(!confirm("You will delete this file? "+O.name))return;const F=await fetch(r+"/browser/files",{method:"DELETE",body:JSON.stringify({type:"files",filename:O.name,folder_path:O.folder_path})});t(4,a=F.ok),a?t(5,i="Deleted the file "+O.name):t(5,i="Failed to delete the file. Please check the ComfyUI server."),t(3,c=!0),setTimeout(()=>t(3,c=!1),2e3),t(1,n=n.filter(v=>v!=O))}const _=async O=>await m(O),w=async O=>await f(O),U=async O=>await M(O);return o.$$set=O=>{"comfyUrl"in O&&t(9,r=O.comfyUrl)},[l,n,s,c,a,i,m,f,M,r,_,w,U]}class lt extends _e{constructor(e){super(),pe(this,e,rt,st,me,{comfyUrl:9})}}function Ne(o,e,t){const r=o.slice();return r[16]=e[t],r}function je(o){let e,t,r,l,n,s,c,a,i=o[16].formattedDatetime+"",m,f,M=o[16].formattedSize+"",_,w,U,O="Load",V,F,v="Remove",$,T,N,ee="Notes:",K,J,Y,C,te,be;t=new Be({props:{file:o[16],styleClass:"w-32 h-full flex justify-center items-center"}});function y(...u){return o[10](o[16],...u)}function d(){return o[11](o[16])}function h(){return o[12](o[16])}function b(...u){return o[13](o[16],...u)}return{c(){e=I("li"),ae(t.$$.fragment),r=H(),l=I("div"),n=I("input"),c=H(),a=I("p"),m=X(i),f=X(" | "),_=X(M),w=H(),U=I("button"),U.textContent=O,V=H(),F=I("button"),F.textContent=v,$=H(),T=I("div"),N=I("p"),N.textContent=ee,K=H(),J=I("textarea"),Y=H(),this.h()},l(u){e=L(u,"LI",{class:!0});var p=A(e);oe(t.$$.fragment,p),r=B(p),l=L(p,"DIV",{class:!0});var g=A(l);n=L(g,"INPUT",{type:!0,class:!0}),c=B(g),a=L(g,"P",{class:!0});var E=A(a);m=x(E,i),f=x(E," | "),_=x(E,M),E.forEach(S),w=B(g),U=L(g,"BUTTON",{class:!0,"data-svelte-h":!0}),he(U)!=="svelte-1hu837"&&(U.textContent=O),V=B(g),F=L(g,"BUTTON",{class:!0,"data-svelte-h":!0}),he(F)!=="svelte-1j21yds"&&(F.textContent=v),g.forEach(S),$=B(p),T=L(p,"DIV",{});var j=A(T);N=L(j,"P",{"data-svelte-h":!0}),he(N)!=="svelte-1biq3pv"&&(N.textContent=ee),K=B(j),J=L(j,"TEXTAREA",{name:!0,cols:!0,rows:!0}),A(J).forEach(S),j.forEach(S),Y=B(p),p.forEach(S),this.h()},h(){k(n,"type","text"),k(n,"class","font-semibold"),n.value=s=o[16].name,k(a,"class","text-gray-500"),k(U,"class","btn btn-ghost"),k(F,"class","btn btn-ghost"),k(l,"class","space-y-2"),k(J,"name","notes"),k(J,"cols","30"),k(J,"rows","4"),k(e,"class","flex h-32 border-2")},m(u,p){P(u,e,p),ie(t,e,null),D(e,r),D(e,l),D(l,n),D(l,c),D(l,a),D(a,m),D(a,f),D(a,_),D(l,w),D(l,U),D(l,V),D(l,F),D(e,$),D(e,T),D(T,N),D(T,K),D(T,J),D(e,Y),C=!0,te||(be=[Q(n,"blur",y),Q(U,"click",d),Q(F,"click",h),Q(J,"blur",b)],te=!0)},p(u,p){o=u;const g={};p&3&&(g.file=o[16]),t.$set(g),(!C||p&3&&s!==(s=o[16].name)&&n.value!==s)&&(n.value=s),(!C||p&3)&&i!==(i=o[16].formattedDatetime+"")&&fe(m,i),(!C||p&3)&&M!==(M=o[16].formattedSize+"")&&fe(_,M)},i(u){C||(W(t.$$.fragment,u),C=!0)},o(u){Z(t.$$.fragment,u),C=!1},d(u){u&&S(e),ce(t),te=!1,De(be)}}}function at(o){let e,t,r,l,n=Te(o[0].slice(0,o[1])),s=[];for(let a=0;a<n.length;a+=1)s[a]=je(Ne(o,n,a));const c=a=>Z(s[a],1,1,()=>{s[a]=null});return r=new Ve({props:{showToast:o[2],toastSuccess:o[3],toastText:o[4]}}),{c(){e=I("ul");for(let a=0;a<s.length;a+=1)s[a].c();t=H(),ae(r.$$.fragment),this.h()},l(a){e=L(a,"UL",{class:!0});var i=A(e);for(let m=0;m<s.length;m+=1)s[m].l(i);i.forEach(S),t=B(a),oe(r.$$.fragment,a),this.h()},h(){k(e,"class","space-y-2")},m(a,i){P(a,e,i);for(let m=0;m<s.length;m+=1)s[m]&&s[m].m(e,null);P(a,t,i),ie(r,a,i),l=!0},p(a,[i]){if(i&483){n=Te(a[0].slice(0,a[1]));let f;for(f=0;f<n.length;f+=1){const M=Ne(a,n,f);s[f]?(s[f].p(M,i),W(s[f],1)):(s[f]=je(M),s[f].c(),W(s[f],1),s[f].m(e,null))}for(ke(),f=n.length;f<s.length;f+=1)c(f);$e()}const m={};i&4&&(m.showToast=a[2]),i&8&&(m.toastSuccess=a[3]),i&16&&(m.toastText=a[4]),r.$set(m)},i(a){if(!l){for(let i=0;i<n.length;i+=1)W(s[i]);W(r.$$.fragment,a),l=!0}},o(a){s=s.filter(Boolean);for(let i=0;i<s.length;i+=1)Z(s[i]);Z(r.$$.fragment,a),l=!1},d(a){a&&(S(e),S(t)),Ye(s,a),ce(r,a)}}}function ot(o,e,t){let{comfyUrl:r}=e,l,n=[],s=20,c=!1,a=!0,i="";Fe(async()=>{l=window.top.comfyApp||r,t(0,n=await Pe("collections",r)),window.addEventListener("scroll",()=>{t(1,s=He(s,n.length))})});async function m(v){const $=await fetch(v.url),T=await $.blob(),N=new File([T],v.name,{type:$.headers.get("Content-Type")||""});await l.handleFile(N)}async function f(v){if(!confirm("You will delete this file? "+v.name))return;const T=await fetch(r+"/browser/files",{method:"DELETE",body:JSON.stringify({type:"collections",filename:v.name,folder_path:v.folder_path})});t(3,a=T.ok),a?t(4,i="Deleted the file "+v.name):t(4,i="Failed to delete the file. Please check the ComfyUI server."),t(2,c=!0),setTimeout(()=>t(2,c=!1),2e3),t(0,n=n.filter(N=>N!=v))}async function M(v,$){return(await fetch(r+"/browser/collections/"+v.name,{method:"PUT",body:JSON.stringify($)})).ok}async function _(v,$){const T=v.target.value,N=await M($,{filename:T,notes:$.notes||"",folder_path:$.folder_path});t(3,a=N),a?t(4,i="Updated"):t(4,i="Failed to Update. Please check the ComfyUI server."),t(2,c=!0),setTimeout(()=>t(2,c=!1),2e3)}async function w(v,$){const T=v.target.value,N=await M($,{filename:$.name,notes:T,folder_path:$.folder_path});t(3,a=N),a?t(4,i="Updated"):t(4,i="Failed to Update. Please check the ComfyUI server."),t(2,c=!0),setTimeout(()=>t(2,c=!1),2e3)}const U=(v,$)=>_($,v),O=async v=>await m(v),V=async v=>await f(v),F=(v,$)=>w($,v);return o.$$set=v=>{"comfyUrl"in v&&t(9,r=v.comfyUrl)},[n,s,c,a,i,m,f,_,w,r,U,O,V,F]}class it extends _e{constructor(e){super(),pe(this,e,ot,at,me,{comfyUrl:9})}}function ct(o){let e,t;return e=new lt({props:{comfyUrl:o[1]}}),{c(){ae(e.$$.fragment)},l(r){oe(e.$$.fragment,r)},m(r,l){ie(e,r,l),t=!0},p:se,i(r){t||(W(e.$$.fragment,r),t=!0)},o(r){Z(e.$$.fragment,r),t=!1},d(r){ce(e,r)}}}function ut(o){let e,t;return e=new it({props:{comfyUrl:o[1]}}),{c(){ae(e.$$.fragment)},l(r){oe(e.$$.fragment,r)},m(r,l){ie(e,r,l),t=!0},p:se,i(r){t||(W(e.$$.fragment,r),t=!0)},o(r){Z(e.$$.fragment,r),t=!1},d(r){ce(e,r)}}}function ft(o){let e,t,r,l,n,s,c;function a(_){o[3](_)}let i={};o[0]!==void 0&&(i.activeTab=o[0]),e=new Re({props:i}),ze.push(()=>Je(e,"activeTab",a));const m=[ut,ct],f=[];function M(_,w){return _[0]==="collections"?0:1}return l=M(o),n=f[l]=m[l](o),{c(){ae(e.$$.fragment),r=H(),n.c(),s=de()},l(_){oe(e.$$.fragment,_),r=B(_),n.l(_),s=de()},m(_,w){ie(e,_,w),P(_,r,w),f[l].m(_,w),P(_,s,w),c=!0},p(_,[w]){const U={};!t&&w&1&&(t=!0,U.activeTab=_[0],We(()=>t=!1)),e.$set(U);let O=l;l=M(_),l===O?f[l].p(_,w):(ke(),Z(f[O],1,1,()=>{f[O]=null}),$e(),n=f[l],n?n.p(_,w):(n=f[l]=m[l](_),n.c()),W(n,1),n.m(s.parentNode,s))},i(_){c||(W(e.$$.fragment,_),W(n),c=!0)},o(_){Z(e.$$.fragment,_),Z(n),c=!1},d(_){_&&(S(r),S(s)),ce(e,_),f[l].d(_)}}}function ht(o,e,t){let{data:r}=e;const{comfyUrl:l}=r;let n="outputs";function s(c){n=c,t(0,n)}return o.$$set=c=>{"data"in c&&t(2,r=c.data)},[n,l,r,s]}class _t extends _e{constructor(e){super(),pe(this,e,ht,ft,me,{data:2})}}export{_t as component};
