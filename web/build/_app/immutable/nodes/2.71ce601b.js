import{s as _e,n as ne,r as ke,f as ye,o as Me,b as Ce,h as Xe}from"../chunks/scheduler.89bf212d.js";import{S as pe,i as be,g as E,m as ee,s as B,h as I,j as V,n as te,f as C,c as z,k as g,a as A,x as k,y as x,l as Oe,z as se,e as me,o as he,r as ie,u as oe,v as ce,d as G,p as Te,b as De,t as Z,A as We,w as ue,B as Ue,C as xe}from"../chunks/index.911dd7e6.js";function $e(t){return(t==null?void 0:t.length)!==void 0?t:Array.from(t)}function et(t){let e,n,s,l,r,a,u,f,o,_;return{c(){e=E("div"),n=E("button"),s=ee("Outputs"),r=B(),a=E("button"),u=ee("Collections"),this.h()},l(h){e=I(h,"DIV",{role:!0,class:!0});var v=V(e);n=I(v,"BUTTON",{role:!0,class:!0});var p=V(n);s=te(p,"Outputs"),p.forEach(C),r=z(v),a=I(v,"BUTTON",{role:!0,class:!0});var d=V(a);u=te(d,"Collections"),d.forEach(C),v.forEach(C),this.h()},h(){g(n,"role","tab"),g(n,"class",l="tab "+t[0]("outputs")),g(a,"role","tab"),g(a,"class",f="tab "+t[0]("collections")),g(e,"role","tablist"),g(e,"class","tabs tabs-boxed sticky top-0")},m(h,v){A(h,e,v),k(e,n),k(n,s),k(e,r),k(e,a),k(a,u),o||(_=[x(n,"click",t[2]),x(a,"click",t[3])],o=!0)},p(h,[v]){v&1&&l!==(l="tab "+h[0]("outputs"))&&g(n,"class",l),v&1&&f!==(f="tab "+h[0]("collections"))&&g(a,"class",f)},i:ne,o:ne,d(h){h&&C(e),o=!1,ke(_)}}}async function Ee(t){let e=new URL(window.location.href);e.searchParams.delete("folder_path"),e.searchParams.set("tab",t),window.location.href=e.toString()}function tt(t,e,n){let s,{activeTab:l="outputs"}=e;const r=()=>Ee("outputs"),a=()=>Ee("collections");return t.$$set=u=>{"activeTab"in u&&n(1,l=u.activeTab)},t.$$.update=()=>{t.$$.dirty&2&&n(0,s=function(u){return u===l?"tab-active":""})},[s,l,r,a]}class nt extends pe{constructor(e){super(),be(this,e,tt,et,_e,{activeTab:1})}}var st=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function lt(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Re={exports:{}};(function(t,e){(function(n,s){t.exports=s()})(st,function(){var n=1e3,s=6e4,l=36e5,r="millisecond",a="second",u="minute",f="hour",o="day",_="week",h="month",v="quarter",p="year",d="date",P="Invalid Date",O=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,F=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,Q={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(D){var c=["th","st","nd","rd"],i=D%100;return"["+D+(c[(i-20)%10]||c[i]||c[0])+"]"}},J=function(D,c,i){var b=String(D);return!b||b.length>=c?D:""+Array(c+1-b.length).join(i)+D},w={s:J,z:function(D){var c=-D.utcOffset(),i=Math.abs(c),b=Math.floor(i/60),m=i%60;return(c<=0?"+":"-")+J(b,2,"0")+":"+J(m,2,"0")},m:function D(c,i){if(c.date()<i.date())return-D(i,c);var b=12*(i.year()-c.year())+(i.month()-c.month()),m=c.clone().add(b,h),T=i-m<0,M=c.clone().add(b+(T?-1:1),h);return+(-(b+(i-m)/(T?m-M:M-m))||0)},a:function(D){return D<0?Math.ceil(D)||0:Math.floor(D)},p:function(D){return{M:h,y:p,w:_,d:o,D:d,h:f,m:u,s:a,ms:r,Q:v}[D]||String(D||"").toLowerCase().replace(/s$/,"")},u:function(D){return D===void 0}},$="en",L={};L[$]=Q;var S="$isDayjsObject",y=function(D){return D instanceof U||!(!D||!D[S])},Y=function D(c,i,b){var m;if(!c)return $;if(typeof c=="string"){var T=c.toLowerCase();L[T]&&(m=T),i&&(L[T]=i,m=T);var M=c.split("-");if(!m&&M.length>1)return D(M[0])}else{var N=c.name;L[N]=c,m=N}return!b&&m&&($=m),m||!b&&$},H=function(D,c){if(y(D))return D.clone();var i=typeof c=="object"?c:{};return i.date=D,i.args=arguments,new U(i)},j=w;j.l=Y,j.i=y,j.w=function(D,c){return H(D,{locale:c.$L,utc:c.$u,x:c.$x,$offset:c.$offset})};var U=function(){function D(i){this.$L=Y(i.locale,null,!0),this.parse(i),this.$x=this.$x||i.x||{},this[S]=!0}var c=D.prototype;return c.parse=function(i){this.$d=function(b){var m=b.date,T=b.utc;if(m===null)return new Date(NaN);if(j.u(m))return new Date;if(m instanceof Date)return new Date(m);if(typeof m=="string"&&!/Z$/i.test(m)){var M=m.match(O);if(M){var N=M[2]-1||0,W=(M[7]||"0").substring(0,3);return T?new Date(Date.UTC(M[1],N,M[3]||1,M[4]||0,M[5]||0,M[6]||0,W)):new Date(M[1],N,M[3]||1,M[4]||0,M[5]||0,M[6]||0,W)}}return new Date(m)}(i),this.init()},c.init=function(){var i=this.$d;this.$y=i.getFullYear(),this.$M=i.getMonth(),this.$D=i.getDate(),this.$W=i.getDay(),this.$H=i.getHours(),this.$m=i.getMinutes(),this.$s=i.getSeconds(),this.$ms=i.getMilliseconds()},c.$utils=function(){return j},c.isValid=function(){return this.$d.toString()!==P},c.isSame=function(i,b){var m=H(i);return this.startOf(b)<=m&&m<=this.endOf(b)},c.isAfter=function(i,b){return H(i)<this.startOf(b)},c.isBefore=function(i,b){return this.endOf(b)<H(i)},c.$g=function(i,b,m){return j.u(i)?this[b]:this.set(m,i)},c.unix=function(){return Math.floor(this.valueOf()/1e3)},c.valueOf=function(){return this.$d.getTime()},c.startOf=function(i,b){var m=this,T=!!j.u(b)||b,M=j.p(i),N=function(ae,K){var le=j.w(m.$u?Date.UTC(m.$y,K,ae):new Date(m.$y,K,ae),m);return T?le:le.endOf(o)},W=function(ae,K){return j.w(m.toDate()[ae].apply(m.toDate("s"),(T?[0,0,0,0]:[23,59,59,999]).slice(K)),m)},R=this.$W,q=this.$M,X=this.$D,de="set"+(this.$u?"UTC":"");switch(M){case p:return T?N(1,0):N(31,11);case h:return T?N(1,q):N(0,q+1);case _:var re=this.$locale().weekStart||0,ve=(R<re?R+7:R)-re;return N(T?X-ve:X+(6-ve),q);case o:case d:return W(de+"Hours",0);case f:return W(de+"Minutes",1);case u:return W(de+"Seconds",2);case a:return W(de+"Milliseconds",3);default:return this.clone()}},c.endOf=function(i){return this.startOf(i,!1)},c.$set=function(i,b){var m,T=j.p(i),M="set"+(this.$u?"UTC":""),N=(m={},m[o]=M+"Date",m[d]=M+"Date",m[h]=M+"Month",m[p]=M+"FullYear",m[f]=M+"Hours",m[u]=M+"Minutes",m[a]=M+"Seconds",m[r]=M+"Milliseconds",m)[T],W=T===o?this.$D+(b-this.$W):b;if(T===h||T===p){var R=this.clone().set(d,1);R.$d[N](W),R.init(),this.$d=R.set(d,Math.min(this.$D,R.daysInMonth())).$d}else N&&this.$d[N](W);return this.init(),this},c.set=function(i,b){return this.clone().$set(i,b)},c.get=function(i){return this[j.p(i)]()},c.add=function(i,b){var m,T=this;i=Number(i);var M=j.p(b),N=function(q){var X=H(T);return j.w(X.date(X.date()+Math.round(q*i)),T)};if(M===h)return this.set(h,this.$M+i);if(M===p)return this.set(p,this.$y+i);if(M===o)return N(1);if(M===_)return N(7);var W=(m={},m[u]=s,m[f]=l,m[a]=n,m)[M]||1,R=this.$d.getTime()+i*W;return j.w(R,this)},c.subtract=function(i,b){return this.add(-1*i,b)},c.format=function(i){var b=this,m=this.$locale();if(!this.isValid())return m.invalidDate||P;var T=i||"YYYY-MM-DDTHH:mm:ssZ",M=j.z(this),N=this.$H,W=this.$m,R=this.$M,q=m.weekdays,X=m.months,de=m.meridiem,re=function(K,le,ge,we){return K&&(K[le]||K(b,T))||ge[le].slice(0,we)},ve=function(K){return j.s(N%12||12,K,"0")},ae=de||function(K,le,ge){var we=K<12?"AM":"PM";return ge?we.toLowerCase():we};return T.replace(F,function(K,le){return le||function(ge){switch(ge){case"YY":return String(b.$y).slice(-2);case"YYYY":return j.s(b.$y,4,"0");case"M":return R+1;case"MM":return j.s(R+1,2,"0");case"MMM":return re(m.monthsShort,R,X,3);case"MMMM":return re(X,R);case"D":return b.$D;case"DD":return j.s(b.$D,2,"0");case"d":return String(b.$W);case"dd":return re(m.weekdaysMin,b.$W,q,2);case"ddd":return re(m.weekdaysShort,b.$W,q,3);case"dddd":return q[b.$W];case"H":return String(N);case"HH":return j.s(N,2,"0");case"h":return ve(1);case"hh":return ve(2);case"a":return ae(N,W,!0);case"A":return ae(N,W,!1);case"m":return String(W);case"mm":return j.s(W,2,"0");case"s":return String(b.$s);case"ss":return j.s(b.$s,2,"0");case"SSS":return j.s(b.$ms,3,"0");case"Z":return M}return null}(K)||M.replace(":","")})},c.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},c.diff=function(i,b,m){var T,M=this,N=j.p(b),W=H(i),R=(W.utcOffset()-this.utcOffset())*s,q=this-W,X=function(){return j.m(M,W)};switch(N){case p:T=X()/12;break;case h:T=X();break;case v:T=X()/3;break;case _:T=(q-R)/6048e5;break;case o:T=(q-R)/864e5;break;case f:T=q/l;break;case u:T=q/s;break;case a:T=q/n;break;default:T=q}return m?T:j.a(T)},c.daysInMonth=function(){return this.endOf(h).$D},c.$locale=function(){return L[this.$L]},c.locale=function(i,b){if(!i)return this.$L;var m=this.clone(),T=Y(i,b,!0);return T&&(m.$L=T),m},c.clone=function(){return j.w(this.$d,this)},c.toDate=function(){return new Date(this.valueOf())},c.toJSON=function(){return this.isValid()?this.toISOString():null},c.toISOString=function(){return this.$d.toISOString()},c.toString=function(){return this.$d.toUTCString()},D}(),fe=U.prototype;return H.prototype=fe,[["$ms",r],["$s",a],["$m",u],["$H",f],["$W",o],["$M",h],["$y",p],["$D",d]].forEach(function(D){fe[D[1]]=function(c){return this.$g(c,D[0],D[1])}}),H.extend=function(D,c){return D.$i||(D(c,U,H),D.$i=!0),H},H.locale=Y,H.isDayjs=y,H.unix=function(D){return H(1e3*D)},H.en=L[$],H.Ls=L,H.p={},H})})(Re);var rt=Re.exports;const Ge=lt(rt);function at(t,e,n){const s=t.name.split(".").pop().toLowerCase();t.fileType="json",["png","webp","jpeg","jpg","gif"].includes(s)&&(t.fileType="image"),["mp4","webm","mov","avi","mkv"].includes(s)&&(t.fileType="video"),e==="collections"?t.url=`${n}/browser/collections/view?filename=${t.name}&folder_path=${t.folder_path}`:t.url=`${n}/view?filename=${t.name}&subfolder=${t.folder_path}`;const l=Ge.unix(t.created_at);return t.formattedDatetime=l.format("YYYY-MM-DD HH-mm-ss"),t.bytes/1024/1024>1?t.formattedSize=(t.bytes/1024/1024).toFixed(2)+" MB":t.formattedSize=Math.round(t.bytes/1024)+" KB",t}function it(t){t.fileType="dir";const e=t.folder_path?`${t.folder_path}/${t.name}`:t.name;let n=new URL(window.location.href);n.searchParams.set("folder_path",e),t.url=n.href;const s=Ge.unix(t.created_at);return t.formattedDatetime=s.format("YYYY-MM-DD HH-mm-ss"),t.formattedSize="0 KB",t}async function Se(t,e){const s=new URLSearchParams(window.location.search).get("folder_path");let l=e+"/browser/"+t;s&&(l=l+`?folder_path=${s}`);let u=(await(await fetch(l)).json()).files;return u.forEach(f=>{f.type==="dir"?f=it(f):f=at(f,t,e)}),u}function qe(t,e){if(t>=e)return t;const n=document.documentElement.scrollHeight;return window.innerHeight+window.scrollY>=n?t+10:t}async function Ze(t,e,n){const s=await fetch(t.url),l=await s.blob(),r=new File([l],t.name,{type:s.headers.get("Content-Type")||""}),a=e.loadGraphData.bind(e);e.loadGraphData=async function(u){var o;const f=(o=window.top)==null?void 0:o.document.getElementById("comfy-browser-dialog");f&&(f.style.display="none"),await a(u)},await e.handleFile(r),n.show(!1,"Loaded","No workflow found here",1e3)}function Ie(t){let e,n='<span class="font-bold text-xl">Folder</span>';return{c(){e=E("div"),e.innerHTML=n,this.h()},l(s){e=I(s,"DIV",{class:!0,"data-svelte-h":!0}),se(e)!=="svelte-114kiz0"&&(e.innerHTML=n),this.h()},h(){g(e,"class","w-full h-full flex items-center justify-center")},m(s,l){A(s,e,l)},d(s){s&&C(e)}}}function Pe(t){let e,n='<span class="font-bold text-xl">JSON</span>';return{c(){e=E("div"),e.innerHTML=n,this.h()},l(s){e=I(s,"DIV",{class:!0,"data-svelte-h":!0}),se(e)!=="svelte-1b6iij2"&&(e.innerHTML=n),this.h()},h(){g(e,"class","w-full h-full flex items-center justify-center")},m(s,l){A(s,e,l)},d(s){s&&C(e)}}}function Le(t){let e,n,s;return{c(){e=E("img"),this.h()},l(l){e=I(l,"IMG",{class:!0,loading:!0,src:!0,alt:!0}),this.h()},h(){g(e,"class","h-full w-full object-contain"),g(e,"loading","lazy"),ye(e.src,n=t[0].url)||g(e,"src",n),g(e,"alt",s=t[0].name)},m(l,r){A(l,e,r)},p(l,r){r&1&&!ye(e.src,n=l[0].url)&&g(e,"src",n),r&1&&s!==(s=l[0].name)&&g(e,"alt",s)},d(l){l&&C(e)}}}function je(t){let e,n,s;return{c(){e=E("video"),n=E("track"),this.h()},l(l){e=I(l,"VIDEO",{class:!0,src:!0});var r=V(e);n=I(r,"TRACK",{kind:!0}),r.forEach(C),this.h()},h(){g(n,"kind","captions"),g(e,"class","h-full w-full object-contain pb-0.5 border-0.5 border-black"),ye(e.src,s=t[0].url)||g(e,"src",s),e.loop=!0,e.autoplay=!0,e.muted=!0},m(l,r){A(l,e,r),k(e,n)},p(l,r){r&1&&!ye(e.src,s=l[0].url)&&g(e,"src",s)},d(l){l&&C(e)}}}function ot(t){let e,n,s,l,r,a,u,f=t[0].type==="dir"&&Ie(),o=t[0].fileType==="json"&&Pe(),_=t[0].fileType==="image"&&Le(t),h=t[0].fileType==="video"&&je(t);return{c(){e=E("div"),n=E("a"),f&&f.c(),s=B(),o&&o.c(),l=B(),_&&_.c(),r=B(),h&&h.c(),this.h()},l(v){e=I(v,"DIV",{class:!0});var p=V(e);n=I(p,"A",{href:!0,target:!0,style:!0});var d=V(n);f&&f.l(d),s=z(d),o&&o.l(d),l=z(d),_&&_.l(d),r=z(d),h&&h.l(d),d.forEach(C),p.forEach(C),this.h()},h(){g(n,"href",a=t[0].url),g(n,"target",u=t[0].type==="dir"?"_self":"_blank"),Oe(n,"height","inherit"),Oe(n,"width","inherit"),g(e,"class",t[1])},m(v,p){A(v,e,p),k(e,n),f&&f.m(n,null),k(n,s),o&&o.m(n,null),k(n,l),_&&_.m(n,null),k(n,r),h&&h.m(n,null)},p(v,[p]){v[0].type==="dir"?f||(f=Ie(),f.c(),f.m(n,s)):f&&(f.d(1),f=null),v[0].fileType==="json"?o||(o=Pe(),o.c(),o.m(n,l)):o&&(o.d(1),o=null),v[0].fileType==="image"?_?_.p(v,p):(_=Le(v),_.c(),_.m(n,r)):_&&(_.d(1),_=null),v[0].fileType==="video"?h?h.p(v,p):(h=je(v),h.c(),h.m(n,null)):h&&(h.d(1),h=null),p&1&&a!==(a=v[0].url)&&g(n,"href",a),p&1&&u!==(u=v[0].type==="dir"?"_self":"_blank")&&g(n,"target",u),p&2&&g(e,"class",v[1])},i:ne,o:ne,d(v){v&&C(e),f&&f.d(),o&&o.d(),_&&_.d(),h&&h.d()}}}function ct(t,e,n){let{file:s}=e,{styleClass:l}=e;return t.$$set=r=>{"file"in r&&n(0,s=r.file),"styleClass"in r&&n(1,l=r.styleClass)},[s,l]}class Ke extends pe{constructor(e){super(),be(this,e,ct,ot,_e,{file:0,styleClass:1})}}function Ne(t){let e,n,s,l,r;return{c(){e=E("div"),n=E("div"),s=E("span"),l=ee(t[2]),this.h()},l(a){e=I(a,"DIV",{class:!0});var u=V(e);n=I(u,"DIV",{class:!0});var f=V(n);s=I(f,"SPAN",{});var o=V(s);l=te(o,t[2]),o.forEach(C),f.forEach(C),u.forEach(C),this.h()},h(){g(n,"class",r="alert "+(t[1]?"alert-success":"alert-error")),g(e,"class","toast toast-center")},m(a,u){A(a,e,u),k(e,n),k(n,s),k(s,l)},p(a,u){u&4&&he(l,a[2]),u&2&&r!==(r="alert "+(a[1]?"alert-success":"alert-error"))&&g(n,"class",r)},d(a){a&&C(e)}}}function ut(t){let e,n=t[0]&&Ne(t);return{c(){n&&n.c(),e=me()},l(s){n&&n.l(s),e=me()},m(s,l){n&&n.m(s,l),A(s,e,l)},p(s,[l]){s[0]?n?n.p(s,l):(n=Ne(s),n.c(),n.m(e.parentNode,e)):n&&(n.d(1),n=null)},i:ne,o:ne,d(s){s&&C(e),n&&n.d(s)}}}function ft(t,e,n){let{showToast:s=!1}=e,{toastSuccess:l=!0}=e,{toastText:r=""}=e;function a(u,f,o,_=2e3){n(1,l=u),n(2,r=u?f:o),n(0,s=!0),setTimeout(()=>n(0,s=!1),_)}return t.$$set=u=>{"showToast"in u&&n(0,s=u.showToast),"toastSuccess"in u&&n(1,l=u.toastSuccess),"toastText"in u&&n(2,r=u.toastText)},[s,l,r,a]}class Qe extends pe{constructor(e){super(),be(this,e,ft,ut,_e,{showToast:0,toastSuccess:1,toastText:2,show:3})}get show(){return this.$$.ctx[3]}}function He(t,e,n){const s=t.slice();return s[11]=e[n],s}function Ye(t){let e,n,s,l,r,a=t[11].name+"",u,f,o,_=t[11].formattedDatetime+"",h,v,p,d=t[11].formattedSize+"",P,O,F,Q,J,w="Collect",$,L,S="Delete",y,Y,H,j;s=new Ke({props:{file:t[11],styleClass:"w-full h-36"}});let U=t[0]&&Fe(t);function fe(){return t[8](t[11])}function D(){return t[9](t[11])}return{c(){e=E("div"),n=E("div"),ie(s.$$.fragment),l=B(),r=E("p"),u=ee(a),f=B(),o=E("p"),h=ee(_),v=B(),p=E("p"),P=ee(d),O=B(),F=E("div"),U&&U.c(),Q=B(),J=E("button"),J.textContent=w,$=B(),L=E("button"),L.textContent=S,y=B(),this.h()},l(c){e=I(c,"DIV",{class:!0});var i=V(e);n=I(i,"DIV",{class:!0});var b=V(n);oe(s.$$.fragment,b),b.forEach(C),l=z(i),r=I(i,"P",{class:!0});var m=V(r);u=te(m,a),m.forEach(C),f=z(i),o=I(i,"P",{class:!0});var T=V(o);h=te(T,_),T.forEach(C),v=z(i),p=I(i,"P",{class:!0});var M=V(p);P=te(M,d),M.forEach(C),O=z(i),F=I(i,"DIV",{class:!0});var N=V(F);U&&U.l(N),Q=z(N),J=I(N,"BUTTON",{class:!0,"data-svelte-h":!0}),se(J)!=="svelte-jct3zc"&&(J.textContent=w),$=z(N),L=I(N,"BUTTON",{class:!0,"data-svelte-h":!0}),se(L)!=="svelte-1t0nfha"&&(L.textContent=S),N.forEach(C),y=z(i),i.forEach(C),this.h()},h(){g(n,"class","flex items-center"),g(r,"class","font-bold max-h-12 leading-6 overflow-auto"),g(o,"class","text-gray-500"),g(p,"class","text-gray-500"),g(J,"class","btn btn-link btn-sm p-0 no-underline text-accent"),g(L,"class","btn btn-link btn-sm p-0 no-underline text-error"),g(F,"class",""),g(e,"class","bg-base-100")},m(c,i){A(c,e,i),k(e,n),ce(s,n,null),k(e,l),k(e,r),k(r,u),k(e,f),k(e,o),k(o,h),k(e,v),k(e,p),k(p,P),k(e,O),k(e,F),U&&U.m(F,null),k(F,Q),k(F,J),k(F,$),k(F,L),k(e,y),Y=!0,H||(j=[x(J,"click",fe),x(L,"click",D)],H=!0)},p(c,i){t=c;const b={};i&6&&(b.file=t[11]),s.$set(b),(!Y||i&6)&&a!==(a=t[11].name+"")&&he(u,a),(!Y||i&6)&&_!==(_=t[11].formattedDatetime+"")&&he(h,_),(!Y||i&6)&&d!==(d=t[11].formattedSize+"")&&he(P,d),t[0]?U?U.p(t,i):(U=Fe(t),U.c(),U.m(F,Q)):U&&(U.d(1),U=null)},i(c){Y||(G(s.$$.fragment,c),Y=!0)},o(c){Z(s.$$.fragment,c),Y=!1},d(c){c&&C(e),ue(s),U&&U.d(),H=!1,ke(j)}}}function Fe(t){let e,n="Load",s,l;function r(){return t[7](t[11])}return{c(){e=E("button"),e.textContent=n,this.h()},l(a){e=I(a,"BUTTON",{class:!0,"data-svelte-h":!0}),se(e)!=="svelte-1ie7fpp"&&(e.textContent=n),this.h()},h(){g(e,"class","btn btn-link btn-sm p-0 no-underline text-accent")},m(a,u){A(a,e,u),s||(l=x(e,"click",r),s=!0)},p(a,u){t=a},d(a){a&&C(e),s=!1,l()}}}function Ve(t){let e=["dir","image","video","json"].includes(t[11].fileType),n,s,l=e&&Ye(t);return{c(){l&&l.c(),n=me()},l(r){l&&l.l(r),n=me()},m(r,a){l&&l.m(r,a),A(r,n,a),s=!0},p(r,a){a&6&&(e=["dir","image","video","json"].includes(r[11].fileType)),e?l?(l.p(r,a),a&6&&G(l,1)):(l=Ye(r),l.c(),G(l,1),l.m(n.parentNode,n)):l&&(Te(),Z(l,1,1,()=>{l=null}),De())},i(r){s||(G(l),s=!0)},o(r){Z(l),s=!1},d(r){r&&C(n),l&&l.d(r)}}}function dt(t){let e,n,s,l,r=$e(t[1].slice(0,t[2])),a=[];for(let o=0;o<r.length;o+=1)a[o]=Ve(He(t,r,o));const u=o=>Z(a[o],1,1,()=>{a[o]=null});let f={};return s=new Qe({props:f}),t[10](s),{c(){e=E("div");for(let o=0;o<a.length;o+=1)a[o].c();n=B(),ie(s.$$.fragment),this.h()},l(o){e=I(o,"DIV",{class:!0});var _=V(e);for(let h=0;h<a.length;h+=1)a[h].l(_);_.forEach(C),n=z(o),oe(s.$$.fragment,o),this.h()},h(){g(e,"class","grid grid-cols-4 lg:grid-cols-6 gap-2 bg-base-300")},m(o,_){A(o,e,_);for(let h=0;h<a.length;h+=1)a[h]&&a[h].m(e,null);A(o,n,_),ce(s,o,_),l=!0},p(o,[_]){if(_&63){r=$e(o[1].slice(0,o[2]));let v;for(v=0;v<r.length;v+=1){const p=He(o,r,v);a[v]?(a[v].p(p,_),G(a[v],1)):(a[v]=Ve(p),a[v].c(),G(a[v],1),a[v].m(e,null))}for(Te(),v=r.length;v<a.length;v+=1)u(v);De()}const h={};s.$set(h)},i(o){if(!l){for(let _=0;_<r.length;_+=1)G(a[_]);G(s.$$.fragment,o),l=!0}},o(o){a=a.filter(Boolean);for(let _=0;_<a.length;_+=1)Z(a[_]);Z(s.$$.fragment,o),l=!1},d(o){o&&(C(e),C(n)),We(a,o),t[10](null),ue(s,o)}}}function ht(t,e,n){let{comfyUrl:s}=e,l,r=[],a=20,u;Me(async()=>{n(0,l=window.top.app),n(1,r=await Se("files",s)),window.addEventListener("scroll",()=>{n(2,a=qe(a,r.length))})});async function f(d){const P=await fetch(s+"/browser/collections",{method:"POST",body:JSON.stringify({filename:d.name,folder_path:d.folder_path})});u.show(P.ok,"Added to collections","Failed to add to collections. Please check the ComfyUI server.")}async function o(d){if(!confirm("You will delete this file? "+d.name))return;const O=await fetch(s+"/browser/files",{method:"DELETE",body:JSON.stringify({type:"files",filename:d.name,folder_path:d.folder_path})});u.show(O.ok,"Deleted the file "+d.name,"Failed to delete the file. Please check the ComfyUI server."),n(1,r=r.filter(F=>F!=d))}const _=async d=>await Ze(d,l,u),h=async d=>await f(d),v=async d=>await o(d);function p(d){Ce[d?"unshift":"push"](()=>{u=d,n(3,u)})}return t.$$set=d=>{"comfyUrl"in d&&n(6,s=d.comfyUrl)},[l,r,a,u,f,o,s,_,h,v,p]}class mt extends pe{constructor(e){super(),be(this,e,ht,dt,_e,{comfyUrl:6})}}function Be(t,e,n){const s=t.slice();return s[20]=e[n],s}function ze(t){let e,n="Save",s,l;return{c(){e=E("button"),e.textContent=n,this.h()},l(r){e=I(r,"BUTTON",{class:!0,"data-svelte-h":!0}),se(e)!=="svelte-vwqboa"&&(e.textContent=n),this.h()},h(){g(e,"class","btn btn-outline btn-accent")},m(r,a){A(r,e,a),s||(l=x(e,"click",t[7]),s=!0)},p:ne,d(r){r&&C(e),s=!1,l()}}}function Ae(t){let e,n="Load",s,l;function r(){return t[14](t[20])}return{c(){e=E("button"),e.textContent=n,this.h()},l(a){e=I(a,"BUTTON",{class:!0,"data-svelte-h":!0}),se(e)!=="svelte-1ie7fpp"&&(e.textContent=n),this.h()},h(){g(e,"class","btn btn-link btn-sm p-0 no-underline text-accent")},m(a,u){A(a,e,u),s||(l=x(e,"click",r),s=!0)},p(a,u){t=a},d(a){a&&C(e),s=!1,l()}}}function Je(t){let e,n,s,l,r,a,u,f,o=t[20].formattedDatetime+"",_,h,v=t[20].formattedSize+"",p,d,P,O,F,Q="Remove",J,w,$,L,S,y,Y,H;n=new Ke({props:{file:t[20],styleClass:"w-36"}});function j(...c){return t[13](t[20],...c)}let U=t[0]&&Ae(t);function fe(){return t[15](t[20])}function D(...c){return t[16](t[20],...c)}return{c(){e=E("li"),ie(n.$$.fragment),s=B(),l=E("div"),r=E("input"),u=B(),f=E("p"),_=ee(o),h=ee(" | "),p=ee(v),d=B(),P=E("div"),U&&U.c(),O=B(),F=E("button"),F.textContent=Q,J=B(),w=E("div"),$=E("textarea"),S=B(),this.h()},l(c){e=I(c,"LI",{class:!0});var i=V(e);oe(n.$$.fragment,i),s=z(i),l=I(i,"DIV",{class:!0});var b=V(l);r=I(b,"INPUT",{type:!0,class:!0}),u=z(b),f=I(b,"P",{class:!0});var m=V(f);_=te(m,o),h=te(m," | "),p=te(m,v),m.forEach(C),d=z(b),P=I(b,"DIV",{});var T=V(P);U&&U.l(T),O=z(T),F=I(T,"BUTTON",{class:!0,"data-svelte-h":!0}),se(F)!=="svelte-1mhg6fb"&&(F.textContent=Q),T.forEach(C),b.forEach(C),J=z(i),w=I(i,"DIV",{});var M=V(w);$=I(M,"TEXTAREA",{name:!0,cols:!0,rows:!0,placeholder:!0,class:!0}),V($).forEach(C),M.forEach(C),S=z(i),i.forEach(C),this.h()},h(){g(r,"type","text"),g(r,"class","input-bordered font-bold w-full bg-base-100"),r.value=a=t[20].name,g(f,"class","text-gray-500"),g(F,"class","btn btn-link btn-sm p-0 no-underline text-error"),g(l,"class","space-y-2 w-72"),g($,"name","notes"),g($,"cols","40"),g($,"rows","4"),g($,"placeholder","write some memos..."),g($,"class","resize-none textarea"),$.value=L=t[20].notes,g(e,"class","flex h-36 border-0 space-x-4 bg-base-100")},m(c,i){A(c,e,i),ce(n,e,null),k(e,s),k(e,l),k(l,r),k(l,u),k(l,f),k(f,_),k(f,h),k(f,p),k(l,d),k(l,P),U&&U.m(P,null),k(P,O),k(P,F),k(e,J),k(e,w),k(w,$),k(e,S),y=!0,Y||(H=[x(r,"blur",j),x(F,"click",fe),x($,"blur",D)],Y=!0)},p(c,i){t=c;const b={};i&18&&(b.file=t[20]),n.$set(b),(!y||i&18&&a!==(a=t[20].name)&&r.value!==a)&&(r.value=a),(!y||i&18)&&o!==(o=t[20].formattedDatetime+"")&&he(_,o),(!y||i&18)&&v!==(v=t[20].formattedSize+"")&&he(p,v),t[0]?U?U.p(t,i):(U=Ae(t),U.c(),U.m(P,O)):U&&(U.d(1),U=null),(!y||i&18&&L!==(L=t[20].notes))&&($.value=L)},i(c){y||(G(n.$$.fragment,c),y=!0)},o(c){Z(n.$$.fragment,c),y=!1},d(c){c&&C(e),ue(n),U&&U.d(),Y=!1,ke(H)}}}function _t(t){var J;let e,n,s,l,r,a="Sync",u,f,o,_,h,v,p,d=t[3]!=((J=t[2])==null?void 0:J.git_repo)&&ze(t),P=$e(t[1].slice(0,t[4])),O=[];for(let w=0;w<P.length;w+=1)O[w]=Je(Be(t,P,w));const F=w=>Z(O[w],1,1,()=>{O[w]=null});let Q={};return _=new Qe({props:Q}),t[17](_),{c(){e=E("div"),n=E("input"),s=B(),d&&d.c(),l=B(),r=E("button"),r.textContent=a,u=B(),f=E("ul");for(let w=0;w<O.length;w+=1)O[w].c();o=B(),ie(_.$$.fragment),this.h()},l(w){e=I(w,"DIV",{});var $=V(e);n=I($,"INPUT",{type:!0,placeholder:!0,class:!0}),s=z($),d&&d.l($),l=z($),r=I($,"BUTTON",{class:!0,"data-svelte-h":!0}),se(r)!=="svelte-118xeor"&&(r.textContent=a),$.forEach(C),u=z(w),f=I(w,"UL",{class:!0});var L=V(f);for(let S=0;S<O.length;S+=1)O[S].l(L);L.forEach(C),o=z(w),oe(_.$$.fragment,w),this.h()},h(){g(n,"type","text"),g(n,"placeholder","Input your git repository address"),g(n,"class","input input-bordered w-full max-w-lg"),g(r,"class","btn btn-outline btn-accent"),g(f,"class","space-y-2 bg-base-300")},m(w,$){A(w,e,$),k(e,n),Ue(n,t[3]),k(e,s),d&&d.m(e,null),k(e,l),k(e,r),A(w,u,$),A(w,f,$);for(let L=0;L<O.length;L+=1)O[L]&&O[L].m(f,null);A(w,o,$),ce(_,w,$),h=!0,v||(p=[x(n,"input",t[12]),x(r,"click",t[6])],v=!0)},p(w,[$]){var S;if($&8&&n.value!==w[3]&&Ue(n,w[3]),w[3]!=((S=w[2])==null?void 0:S.git_repo)?d?d.p(w,$):(d=ze(w),d.c(),d.m(e,l)):d&&(d.d(1),d=null),$&1843){P=$e(w[1].slice(0,w[4]));let y;for(y=0;y<P.length;y+=1){const Y=Be(w,P,y);O[y]?(O[y].p(Y,$),G(O[y],1)):(O[y]=Je(Y),O[y].c(),G(O[y],1),O[y].m(f,null))}for(Te(),y=P.length;y<O.length;y+=1)F(y);De()}const L={};_.$set(L)},i(w){if(!h){for(let $=0;$<P.length;$+=1)G(O[$]);G(_.$$.fragment,w),h=!0}},o(w){O=O.filter(Boolean);for(let $=0;$<O.length;$+=1)Z(O[$]);Z(_.$$.fragment,w),h=!1},d(w){w&&(C(e),C(u),C(f),C(o)),d&&d.d(),We(O,w),t[17](null),ue(_,w),v=!1,ke(p)}}}function pt(t,e,n){let{comfyUrl:s}=e,l,r=[],a={},u="",f=20,o;Me(async()=>{n(0,l=window.top.app),n(1,r=await Se("collections",s)),n(2,a=await _()||{}),n(3,u=a==null?void 0:a.git_repo),window.addEventListener("scroll",()=>{n(4,f=qe(f,r.length))})});async function _(){return await(await fetch(s+"/browser/config")).json()}async function h(S){const y=S.target;y.disabled=!0,y.innerHTML="Syncing...";const Y=await fetch(s+"/browser/collections/sync",{method:"POST"});o.show(Y.ok,"Synced","Failed to sync. Please check the ComfyUI server."),y.disabled=!1,y.innerHTML="Sync",n(1,r=await Se("collections",s))}async function v(){const S=await fetch(s+"/browser/config",{method:"PUT",body:JSON.stringify({git_repo:u})});o.show(S.ok,"Updated config","Failed to update config. Please check the ComfyUI server.")}async function p(S){if(!confirm("You will delete this file? "+S.name))return;const Y=await fetch(s+"/browser/files",{method:"DELETE",body:JSON.stringify({type:"collections",filename:S.name,folder_path:S.folder_path})});o.show(Y.ok,"Deleted the file "+S.name,"Failed to delete the file. Please check the ComfyUI server."),n(1,r=r.filter(H=>H!=S))}async function d(S,y){return(await fetch(s+"/browser/collections/"+S.name,{method:"PUT",body:JSON.stringify(y)})).ok}async function P(S,y){const Y=S.target.value;if(Y===y.name)return;const H=await d(y,{filename:Y,notes:y.notes||"",folder_path:y.folder_path});o.show(H,"Updated","Failed to update. Please check the ComfyUI server.")}async function O(S,y){const Y=S.target.value;if(Y==y.notes)return;const H=await d(y,{filename:y.name,notes:Y,folder_path:y.folder_path});o.show(H,"Updated","Failed to update. Please check the ComfyUI server.")}function F(){u=this.value,n(3,u)}const Q=(S,y)=>P(y,S),J=async S=>await Ze(S,l,o),w=async S=>await p(S),$=(S,y)=>O(y,S);function L(S){Ce[S?"unshift":"push"](()=>{o=S,n(5,o)})}return t.$$set=S=>{"comfyUrl"in S&&n(11,s=S.comfyUrl)},[l,r,a,u,f,o,h,v,p,P,O,s,F,Q,J,w,$,L]}class bt extends pe{constructor(e){super(),be(this,e,pt,_t,_e,{comfyUrl:11})}}function vt(t){let e,n;return e=new mt({props:{comfyUrl:t[1]}}),{c(){ie(e.$$.fragment)},l(s){oe(e.$$.fragment,s)},m(s,l){ce(e,s,l),n=!0},p:ne,i(s){n||(G(e.$$.fragment,s),n=!0)},o(s){Z(e.$$.fragment,s),n=!1},d(s){ue(e,s)}}}function gt(t){let e,n;return e=new bt({props:{comfyUrl:t[1]}}),{c(){ie(e.$$.fragment)},l(s){oe(e.$$.fragment,s)},m(s,l){ce(e,s,l),n=!0},p:ne,i(s){n||(G(e.$$.fragment,s),n=!0)},o(s){Z(e.$$.fragment,s),n=!1},d(s){ue(e,s)}}}function wt(t){let e,n,s,l,r,a,u;function f(p){t[3](p)}let o={};t[0]!==void 0&&(o.activeTab=t[0]),e=new nt({props:o}),Ce.push(()=>xe(e,"activeTab",f));const _=[gt,vt],h=[];function v(p,d){return p[0]==="collections"?0:1}return l=v(t),r=h[l]=_[l](t),{c(){ie(e.$$.fragment),s=B(),r.c(),a=me()},l(p){oe(e.$$.fragment,p),s=z(p),r.l(p),a=me()},m(p,d){ce(e,p,d),A(p,s,d),h[l].m(p,d),A(p,a,d),u=!0},p(p,[d]){const P={};!n&&d&1&&(n=!0,P.activeTab=p[0],Xe(()=>n=!1)),e.$set(P);let O=l;l=v(p),l===O?h[l].p(p,d):(Te(),Z(h[O],1,1,()=>{h[O]=null}),De(),r=h[l],r?r.p(p,d):(r=h[l]=_[l](p),r.c()),G(r,1),r.m(a.parentNode,a))},i(p){u||(G(e.$$.fragment,p),G(r),u=!0)},o(p){Z(e.$$.fragment,p),Z(r),u=!1},d(p){p&&(C(s),C(a)),ue(e,p),h[l].d(p)}}}function yt(t,e,n){let{data:s}=e;const{comfyUrl:l}=s,r=["collections","files"];let a="outputs";Me(()=>{const o=new URLSearchParams(window.location.search).get("tab");o&&r.includes(o)&&n(0,a=o)});function u(f){a=f,n(0,a)}return t.$$set=f=>{"data"in f&&n(2,s=f.data)},[a,l,s,u]}class Tt extends pe{constructor(e){super(),be(this,e,yt,wt,_e,{data:2})}}export{Tt as component};
