import{s as _e,n as ne,r as ke,f as ye,o as Be,b as Ce,h as Ze}from"../chunks/scheduler.89bf212d.js";import{S as pe,i as be,g as N,m as ee,s as A,h as L,j as Y,n as te,f as O,c as V,k as v,a as J,x as D,y as x,l as Me,z as le,e as me,o as de,r as ae,u as oe,v as ce,d as R,p as Te,b as De,t as K,A as ze,w as ue,B as Oe,C as Ge}from"../chunks/index.911dd7e6.js";function $e(s){return(s==null?void 0:s.length)!==void 0?s:Array.from(s)}function Ke(s){let e,t,n,r,l,i,c,h,o,m;return{c(){e=N("div"),t=N("button"),n=ee("Outputs"),l=A(),i=N("button"),c=ee("Collections"),this.h()},l(p){e=L(p,"DIV",{role:!0,class:!0});var k=Y(e);t=L(k,"BUTTON",{role:!0,class:!0});var b=Y(t);n=te(b,"Outputs"),b.forEach(O),l=V(k),i=L(k,"BUTTON",{role:!0,class:!0});var y=Y(i);c=te(y,"Collections"),y.forEach(O),k.forEach(O),this.h()},h(){v(t,"role","tab"),v(t,"class",r="tab "+s[0]("outputs")),v(i,"role","tab"),v(i,"class",h="tab "+s[0]("collections")),v(e,"role","tablist"),v(e,"class","tabs tabs-boxed sticky top-0")},m(p,k){J(p,e,k),D(e,t),D(t,n),D(e,l),D(e,i),D(i,c),o||(m=[x(t,"click",s[3]),x(i,"click",s[4])],o=!0)},p(p,[k]){k&1&&r!==(r="tab "+p[0]("outputs"))&&v(t,"class",r),k&1&&h!==(h="tab "+p[0]("collections"))&&v(i,"class",h)},i:ne,o:ne,d(p){p&&O(e),o=!1,ke(m)}}}function Qe(s,e,t){let n,{activeTab:r="outputs"}=e;function l(h){t(2,r=h)}const i=()=>l("outputs"),c=()=>l("collections");return s.$$set=h=>{"activeTab"in h&&t(2,r=h.activeTab)},s.$$.update=()=>{s.$$.dirty&4&&t(0,n=function(h){return h===r?"tab-active":""})},[n,l,r,i,c]}class Xe extends pe{constructor(e){super(),be(this,e,Qe,Ke,_e,{activeTab:2})}}var xe=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function et(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}var Je={exports:{}};(function(s,e){(function(t,n){s.exports=n()})(xe,function(){var t=1e3,n=6e4,r=36e5,l="millisecond",i="second",c="minute",h="hour",o="day",m="week",p="month",k="quarter",b="year",y="date",g="Invalid Date",S=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,H=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,Z={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(C){var u=["th","st","nd","rd"],a=C%100;return"["+C+(u[(a-20)%10]||u[a]||u[0])+"]"}},B=function(C,u,a){var d=String(C);return!d||d.length>=u?C:""+Array(u+1-d.length).join(a)+C},w={s:B,z:function(C){var u=-C.utcOffset(),a=Math.abs(u),d=Math.floor(a/60),f=a%60;return(u<=0?"+":"-")+B(d,2,"0")+":"+B(f,2,"0")},m:function C(u,a){if(u.date()<a.date())return-C(a,u);var d=12*(a.year()-u.year())+(a.month()-u.month()),f=u.clone().add(d,p),T=a-f<0,M=u.clone().add(d+(T?-1:1),p);return+(-(d+(a-f)/(T?f-M:M-f))||0)},a:function(C){return C<0?Math.ceil(C)||0:Math.floor(C)},p:function(C){return{M:p,y:b,w:m,d:o,D:y,h,m:c,s:i,ms:l,Q:k}[C]||String(C||"").toLowerCase().replace(/s$/,"")},u:function(C){return C===void 0}},$="en",P={};P[$]=Z;var W="$isDayjsObject",_=function(C){return C instanceof j||!(!C||!C[W])},E=function C(u,a,d){var f;if(!u)return $;if(typeof u=="string"){var T=u.toLowerCase();P[T]&&(f=T),a&&(P[T]=a,f=T);var M=u.split("-");if(!f&&M.length>1)return C(M[0])}else{var F=u.name;P[F]=u,f=F}return!d&&f&&($=f),f||!d&&$},I=function(C,u){if(_(C))return C.clone();var a=typeof u=="object"?u:{};return a.date=C,a.args=arguments,new j(a)},U=w;U.l=E,U.i=_,U.w=function(C,u){return I(C,{locale:u.$L,utc:u.$u,x:u.$x,$offset:u.$offset})};var j=function(){function C(a){this.$L=E(a.locale,null,!0),this.parse(a),this.$x=this.$x||a.x||{},this[W]=!0}var u=C.prototype;return u.parse=function(a){this.$d=function(d){var f=d.date,T=d.utc;if(f===null)return new Date(NaN);if(U.u(f))return new Date;if(f instanceof Date)return new Date(f);if(typeof f=="string"&&!/Z$/i.test(f)){var M=f.match(S);if(M){var F=M[2]-1||0,z=(M[7]||"0").substring(0,3);return T?new Date(Date.UTC(M[1],F,M[3]||1,M[4]||0,M[5]||0,M[6]||0,z)):new Date(M[1],F,M[3]||1,M[4]||0,M[5]||0,M[6]||0,z)}}return new Date(f)}(a),this.init()},u.init=function(){var a=this.$d;this.$y=a.getFullYear(),this.$M=a.getMonth(),this.$D=a.getDate(),this.$W=a.getDay(),this.$H=a.getHours(),this.$m=a.getMinutes(),this.$s=a.getSeconds(),this.$ms=a.getMilliseconds()},u.$utils=function(){return U},u.isValid=function(){return this.$d.toString()!==g},u.isSame=function(a,d){var f=I(a);return this.startOf(d)<=f&&f<=this.endOf(d)},u.isAfter=function(a,d){return I(a)<this.startOf(d)},u.isBefore=function(a,d){return this.endOf(d)<I(a)},u.$g=function(a,d,f){return U.u(a)?this[d]:this.set(f,a)},u.unix=function(){return Math.floor(this.valueOf()/1e3)},u.valueOf=function(){return this.$d.getTime()},u.startOf=function(a,d){var f=this,T=!!U.u(d)||d,M=U.p(a),F=function(ie,Q){var se=U.w(f.$u?Date.UTC(f.$y,Q,ie):new Date(f.$y,Q,ie),f);return T?se:se.endOf(o)},z=function(ie,Q){return U.w(f.toDate()[ie].apply(f.toDate("s"),(T?[0,0,0,0]:[23,59,59,999]).slice(Q)),f)},q=this.$W,G=this.$M,X=this.$D,he="set"+(this.$u?"UTC":"");switch(M){case b:return T?F(1,0):F(31,11);case p:return T?F(1,G):F(0,G+1);case m:var re=this.$locale().weekStart||0,ve=(q<re?q+7:q)-re;return F(T?X-ve:X+(6-ve),G);case o:case y:return z(he+"Hours",0);case h:return z(he+"Minutes",1);case c:return z(he+"Seconds",2);case i:return z(he+"Milliseconds",3);default:return this.clone()}},u.endOf=function(a){return this.startOf(a,!1)},u.$set=function(a,d){var f,T=U.p(a),M="set"+(this.$u?"UTC":""),F=(f={},f[o]=M+"Date",f[y]=M+"Date",f[p]=M+"Month",f[b]=M+"FullYear",f[h]=M+"Hours",f[c]=M+"Minutes",f[i]=M+"Seconds",f[l]=M+"Milliseconds",f)[T],z=T===o?this.$D+(d-this.$W):d;if(T===p||T===b){var q=this.clone().set(y,1);q.$d[F](z),q.init(),this.$d=q.set(y,Math.min(this.$D,q.daysInMonth())).$d}else F&&this.$d[F](z);return this.init(),this},u.set=function(a,d){return this.clone().$set(a,d)},u.get=function(a){return this[U.p(a)]()},u.add=function(a,d){var f,T=this;a=Number(a);var M=U.p(d),F=function(G){var X=I(T);return U.w(X.date(X.date()+Math.round(G*a)),T)};if(M===p)return this.set(p,this.$M+a);if(M===b)return this.set(b,this.$y+a);if(M===o)return F(1);if(M===m)return F(7);var z=(f={},f[c]=n,f[h]=r,f[i]=t,f)[M]||1,q=this.$d.getTime()+a*z;return U.w(q,this)},u.subtract=function(a,d){return this.add(-1*a,d)},u.format=function(a){var d=this,f=this.$locale();if(!this.isValid())return f.invalidDate||g;var T=a||"YYYY-MM-DDTHH:mm:ssZ",M=U.z(this),F=this.$H,z=this.$m,q=this.$M,G=f.weekdays,X=f.months,he=f.meridiem,re=function(Q,se,ge,we){return Q&&(Q[se]||Q(d,T))||ge[se].slice(0,we)},ve=function(Q){return U.s(F%12||12,Q,"0")},ie=he||function(Q,se,ge){var we=Q<12?"AM":"PM";return ge?we.toLowerCase():we};return T.replace(H,function(Q,se){return se||function(ge){switch(ge){case"YY":return String(d.$y).slice(-2);case"YYYY":return U.s(d.$y,4,"0");case"M":return q+1;case"MM":return U.s(q+1,2,"0");case"MMM":return re(f.monthsShort,q,X,3);case"MMMM":return re(X,q);case"D":return d.$D;case"DD":return U.s(d.$D,2,"0");case"d":return String(d.$W);case"dd":return re(f.weekdaysMin,d.$W,G,2);case"ddd":return re(f.weekdaysShort,d.$W,G,3);case"dddd":return G[d.$W];case"H":return String(F);case"HH":return U.s(F,2,"0");case"h":return ve(1);case"hh":return ve(2);case"a":return ie(F,z,!0);case"A":return ie(F,z,!1);case"m":return String(z);case"mm":return U.s(z,2,"0");case"s":return String(d.$s);case"ss":return U.s(d.$s,2,"0");case"SSS":return U.s(d.$ms,3,"0");case"Z":return M}return null}(Q)||M.replace(":","")})},u.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},u.diff=function(a,d,f){var T,M=this,F=U.p(d),z=I(a),q=(z.utcOffset()-this.utcOffset())*n,G=this-z,X=function(){return U.m(M,z)};switch(F){case b:T=X()/12;break;case p:T=X();break;case k:T=X()/3;break;case m:T=(G-q)/6048e5;break;case o:T=(G-q)/864e5;break;case h:T=G/r;break;case c:T=G/n;break;case i:T=G/t;break;default:T=G}return f?T:U.a(T)},u.daysInMonth=function(){return this.endOf(p).$D},u.$locale=function(){return P[this.$L]},u.locale=function(a,d){if(!a)return this.$L;var f=this.clone(),T=E(a,d,!0);return T&&(f.$L=T),f},u.clone=function(){return U.w(this.$d,this)},u.toDate=function(){return new Date(this.valueOf())},u.toJSON=function(){return this.isValid()?this.toISOString():null},u.toISOString=function(){return this.$d.toISOString()},u.toString=function(){return this.$d.toUTCString()},C}(),fe=j.prototype;return I.prototype=fe,[["$ms",l],["$s",i],["$m",c],["$H",h],["$W",o],["$M",p],["$y",b],["$D",y]].forEach(function(C){fe[C[1]]=function(u){return this.$g(u,C[0],C[1])}}),I.extend=function(C,u){return C.$i||(C(u,j,I),C.$i=!0),I},I.locale=E,I.isDayjs=_,I.unix=function(C){return I(1e3*C)},I.en=P[$],I.Ls=P,I.p={},I})})(Je);var tt=Je.exports;const nt=et(tt);async function Se(s,e){let r=(await(await fetch(e+"/browser/"+s)).json()).files;return r.forEach(l=>{const i=l.name.split(".").pop().toLowerCase();l.fileType="json",["png","webp","jpeg","jpg","gif"].includes(i)&&(l.fileType="image"),["mp4","webm","mov","avi","mkv"].includes(i)&&(l.fileType="video"),s==="collections"?l.url=`${e}/browser/collections/view?filename=${l.name}`:l.url=`${e}/view?filename=${l.name}`;const c=nt.unix(l.created_at);l.formattedDatetime=c.format("YYYY-MM-DD HH-mm-ss"),l.bytes/1024/1024>1?l.formattedSize=(l.bytes/1024/1024).toFixed(2)+" MB":l.formattedSize=Math.round(l.bytes/1024)+" KB"}),r}function We(s,e){if(s>=e)return s;const t=document.documentElement.scrollHeight;return window.innerHeight+window.scrollY>=t?s+10:s}function Ee(s){let e,t='<span class="font-bold text-xl">JSON</span>';return{c(){e=N("div"),e.innerHTML=t,this.h()},l(n){e=L(n,"DIV",{class:!0,"data-svelte-h":!0}),le(e)!=="svelte-1b6iij2"&&(e.innerHTML=t),this.h()},h(){v(e,"class","w-full h-full flex items-center justify-center")},m(n,r){J(n,e,r)},d(n){n&&O(e)}}}function Ue(s){let e,t,n;return{c(){e=N("img"),this.h()},l(r){e=L(r,"IMG",{class:!0,loading:!0,src:!0,alt:!0}),this.h()},h(){v(e,"class","h-full w-full object-contain"),v(e,"loading","lazy"),ye(e.src,t=s[0].url)||v(e,"src",t),v(e,"alt",n=s[0].name)},m(r,l){J(r,e,l)},p(r,l){l&1&&!ye(e.src,t=r[0].url)&&v(e,"src",t),l&1&&n!==(n=r[0].name)&&v(e,"alt",n)},d(r){r&&O(e)}}}function Ie(s){let e,t,n;return{c(){e=N("video"),t=N("track"),this.h()},l(r){e=L(r,"VIDEO",{class:!0,src:!0});var l=Y(e);t=L(l,"TRACK",{kind:!0}),l.forEach(O),this.h()},h(){v(t,"kind","captions"),v(e,"class","h-full w-full object-contain pb-0.5 border-0.5 border-black"),ye(e.src,n=s[0].url)||v(e,"src",n),e.loop=!0,e.autoplay=!0,e.muted=!0},m(r,l){J(r,e,l),D(e,t)},p(r,l){l&1&&!ye(e.src,n=r[0].url)&&v(e,"src",n)},d(r){r&&O(e)}}}function st(s){let e,t,n,r,l,i=s[0].fileType==="json"&&Ee(),c=s[0].fileType==="image"&&Ue(s),h=s[0].fileType==="video"&&Ie(s);return{c(){e=N("div"),t=N("a"),i&&i.c(),n=A(),c&&c.c(),r=A(),h&&h.c(),this.h()},l(o){e=L(o,"DIV",{class:!0});var m=Y(e);t=L(m,"A",{href:!0,target:!0,style:!0});var p=Y(t);i&&i.l(p),n=V(p),c&&c.l(p),r=V(p),h&&h.l(p),p.forEach(O),m.forEach(O),this.h()},h(){v(t,"href",l=s[0].url),v(t,"target","_blank"),Me(t,"height","inherit"),Me(t,"width","inherit"),v(e,"class",s[1])},m(o,m){J(o,e,m),D(e,t),i&&i.m(t,null),D(t,n),c&&c.m(t,null),D(t,r),h&&h.m(t,null)},p(o,[m]){o[0].fileType==="json"?i||(i=Ee(),i.c(),i.m(t,n)):i&&(i.d(1),i=null),o[0].fileType==="image"?c?c.p(o,m):(c=Ue(o),c.c(),c.m(t,r)):c&&(c.d(1),c=null),o[0].fileType==="video"?h?h.p(o,m):(h=Ie(o),h.c(),h.m(t,null)):h&&(h.d(1),h=null),m&1&&l!==(l=o[0].url)&&v(t,"href",l),m&2&&v(e,"class",o[1])},i:ne,o:ne,d(o){o&&O(e),i&&i.d(),c&&c.d(),h&&h.d()}}}function lt(s,e,t){let{file:n}=e,{styleClass:r}=e;return s.$$set=l=>{"file"in l&&t(0,n=l.file),"styleClass"in l&&t(1,r=l.styleClass)},[n,r]}class qe extends pe{constructor(e){super(),be(this,e,lt,st,_e,{file:0,styleClass:1})}}function je(s){let e,t,n,r,l;return{c(){e=N("div"),t=N("div"),n=N("span"),r=ee(s[1]),this.h()},l(i){e=L(i,"DIV",{class:!0});var c=Y(e);t=L(c,"DIV",{class:!0});var h=Y(t);n=L(h,"SPAN",{});var o=Y(n);r=te(o,s[1]),o.forEach(O),h.forEach(O),c.forEach(O),this.h()},h(){v(t,"class",l="alert "+(s[2]?"alert-success":"alert-error")),v(e,"class","toast toast-center")},m(i,c){J(i,e,c),D(e,t),D(t,n),D(n,r)},p(i,c){c&2&&de(r,i[1]),c&4&&l!==(l="alert "+(i[2]?"alert-success":"alert-error"))&&v(t,"class",l)},d(i){i&&O(e)}}}function rt(s){let e,t=s[0]&&je(s);return{c(){t&&t.c(),e=me()},l(n){t&&t.l(n),e=me()},m(n,r){t&&t.m(n,r),J(n,e,r)},p(n,[r]){n[0]?t?t.p(n,r):(t=je(n),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},i:ne,o:ne,d(n){n&&O(e),t&&t.d(n)}}}function it(s,e,t){let{showToast:n=!1}=e,{toastSuccess:r=!0}=e,{toastText:l=""}=e;function i(c,h,o,m=2e3){t(1,l=c?h:o),t(0,n=!0),setTimeout(()=>t(0,n=!1),m)}return s.$$set=c=>{"showToast"in c&&t(0,n=c.showToast),"toastSuccess"in c&&t(2,r=c.toastSuccess),"toastText"in c&&t(1,l=c.toastText)},[n,l,r,i]}class Re extends pe{constructor(e){super(),be(this,e,it,rt,_e,{showToast:0,toastSuccess:2,toastText:1,show:3})}get show(){return this.$$.ctx[3]}}function Ne(s,e,t){const n=s.slice();return n[12]=e[t],n}function Le(s){let e,t,n,r,l,i=s[12].name+"",c,h,o,m=s[12].formattedDatetime+"",p,k,b,y=s[12].formattedSize+"",g,S,H,Z,B,w="Collect",$,P,W="Delete",_,E,I,U;n=new qe({props:{file:s[12],styleClass:"w-full h-36"}});let j=s[0]&&Pe(s);function fe(){return s[9](s[12])}function C(){return s[10](s[12])}return{c(){e=N("div"),t=N("div"),ae(n.$$.fragment),r=A(),l=N("p"),c=ee(i),h=A(),o=N("p"),p=ee(m),k=A(),b=N("p"),g=ee(y),S=A(),H=N("div"),j&&j.c(),Z=A(),B=N("button"),B.textContent=w,$=A(),P=N("button"),P.textContent=W,_=A(),this.h()},l(u){e=L(u,"DIV",{class:!0});var a=Y(e);t=L(a,"DIV",{class:!0});var d=Y(t);oe(n.$$.fragment,d),d.forEach(O),r=V(a),l=L(a,"P",{class:!0});var f=Y(l);c=te(f,i),f.forEach(O),h=V(a),o=L(a,"P",{class:!0});var T=Y(o);p=te(T,m),T.forEach(O),k=V(a),b=L(a,"P",{class:!0});var M=Y(b);g=te(M,y),M.forEach(O),S=V(a),H=L(a,"DIV",{class:!0});var F=Y(H);j&&j.l(F),Z=V(F),B=L(F,"BUTTON",{class:!0,"data-svelte-h":!0}),le(B)!=="svelte-jct3zc"&&(B.textContent=w),$=V(F),P=L(F,"BUTTON",{class:!0,"data-svelte-h":!0}),le(P)!=="svelte-1t0nfha"&&(P.textContent=W),F.forEach(O),_=V(a),a.forEach(O),this.h()},h(){v(t,"class","flex items-center"),v(l,"class","font-bold max-h-12 leading-6 overflow-auto"),v(o,"class","text-gray-500"),v(b,"class","text-gray-500"),v(B,"class","btn btn-link btn-sm p-0 no-underline text-accent"),v(P,"class","btn btn-link btn-sm p-0 no-underline text-error"),v(H,"class",""),v(e,"class","bg-base-100")},m(u,a){J(u,e,a),D(e,t),ce(n,t,null),D(e,r),D(e,l),D(l,c),D(e,h),D(e,o),D(o,p),D(e,k),D(e,b),D(b,g),D(e,S),D(e,H),j&&j.m(H,null),D(H,Z),D(H,B),D(H,$),D(H,P),D(e,_),E=!0,I||(U=[x(B,"click",fe),x(P,"click",C)],I=!0)},p(u,a){s=u;const d={};a&6&&(d.file=s[12]),n.$set(d),(!E||a&6)&&i!==(i=s[12].name+"")&&de(c,i),(!E||a&6)&&m!==(m=s[12].formattedDatetime+"")&&de(p,m),(!E||a&6)&&y!==(y=s[12].formattedSize+"")&&de(g,y),s[0]?j?j.p(s,a):(j=Pe(s),j.c(),j.m(H,Z)):j&&(j.d(1),j=null)},i(u){E||(R(n.$$.fragment,u),E=!0)},o(u){K(n.$$.fragment,u),E=!1},d(u){u&&O(e),ue(n),j&&j.d(),I=!1,ke(U)}}}function Pe(s){let e,t="Load",n,r;function l(){return s[8](s[12])}return{c(){e=N("button"),e.textContent=t,this.h()},l(i){e=L(i,"BUTTON",{class:!0,"data-svelte-h":!0}),le(e)!=="svelte-58jb7k"&&(e.textContent=t),this.h()},h(){v(e,"class","btn btn-link btn-sm p-0 no-underline text-accent")},m(i,c){J(i,e,c),n||(r=x(e,"click",l),n=!0)},p(i,c){s=i},d(i){i&&O(e),n=!1,r()}}}function Fe(s){let e=["image","video"].includes(s[12].fileType),t,n,r=e&&Le(s);return{c(){r&&r.c(),t=me()},l(l){r&&r.l(l),t=me()},m(l,i){r&&r.m(l,i),J(l,t,i),n=!0},p(l,i){i&6&&(e=["image","video"].includes(l[12].fileType)),e?r?(r.p(l,i),i&6&&R(r,1)):(r=Le(l),r.c(),R(r,1),r.m(t.parentNode,t)):r&&(Te(),K(r,1,1,()=>{r=null}),De())},i(l){n||(R(r),n=!0)},o(l){K(r),n=!1},d(l){l&&O(t),r&&r.d(l)}}}function at(s){let e,t,n,r,l=$e(s[1].slice(0,s[2])),i=[];for(let o=0;o<l.length;o+=1)i[o]=Fe(Ne(s,l,o));const c=o=>K(i[o],1,1,()=>{i[o]=null});let h={};return n=new Re({props:h}),s[11](n),{c(){e=N("div");for(let o=0;o<i.length;o+=1)i[o].c();t=A(),ae(n.$$.fragment),this.h()},l(o){e=L(o,"DIV",{class:!0});var m=Y(e);for(let p=0;p<i.length;p+=1)i[p].l(m);m.forEach(O),t=V(o),oe(n.$$.fragment,o),this.h()},h(){v(e,"class","grid grid-cols-4 lg:grid-cols-6 gap-2 bg-base-300")},m(o,m){J(o,e,m);for(let p=0;p<i.length;p+=1)i[p]&&i[p].m(e,null);J(o,t,m),ce(n,o,m),r=!0},p(o,[m]){if(m&119){l=$e(o[1].slice(0,o[2]));let k;for(k=0;k<l.length;k+=1){const b=Ne(o,l,k);i[k]?(i[k].p(b,m),R(i[k],1)):(i[k]=Fe(b),i[k].c(),R(i[k],1),i[k].m(e,null))}for(Te(),k=l.length;k<i.length;k+=1)c(k);De()}const p={};n.$set(p)},i(o){if(!r){for(let m=0;m<l.length;m+=1)R(i[m]);R(n.$$.fragment,o),r=!0}},o(o){i=i.filter(Boolean);for(let m=0;m<i.length;m+=1)K(i[m]);K(n.$$.fragment,o),r=!1},d(o){o&&(O(e),O(t)),ze(i,o),s[11](null),ue(n,o)}}}function ot(s,e,t){let{comfyUrl:n}=e,r,l=[],i=20,c;Be(async()=>{t(0,r=window.top.comfyApp),t(1,l=await Se("files",n)),window.addEventListener("scroll",()=>{t(2,i=We(i,l.length))})});async function h(g){const S=await fetch(g.url),H=await S.blob(),Z=new File([H],g.name,{type:S.headers.get("Content-Type")||""});await r.handleFile(Z)}async function o(g){const S=await fetch(n+"/browser/collections",{method:"POST",body:JSON.stringify({filename:g.name,folder_path:g.folder_path})});c.show(S.ok,"Added to collections","Failed to add to collections. Please check the ComfyUI server.")}async function m(g){if(!confirm("You will delete this file? "+g.name))return;const H=await fetch(n+"/browser/files",{method:"DELETE",body:JSON.stringify({type:"files",filename:g.name,folder_path:g.folder_path})});c.show(H.ok,"Deleted the file "+g.name,"Failed to delete the file. Please check the ComfyUI server."),t(1,l=l.filter(Z=>Z!=g))}const p=async g=>await h(g),k=async g=>await o(g),b=async g=>await m(g);function y(g){Ce[g?"unshift":"push"](()=>{c=g,t(3,c)})}return s.$$set=g=>{"comfyUrl"in g&&t(7,n=g.comfyUrl)},[r,l,i,c,h,o,m,n,p,k,b,y]}class ct extends pe{constructor(e){super(),be(this,e,ot,at,_e,{comfyUrl:7})}}function He(s,e,t){const n=s.slice();return n[21]=e[t],n}function Ye(s){let e,t="Save",n,r;return{c(){e=N("button"),e.textContent=t,this.h()},l(l){e=L(l,"BUTTON",{class:!0,"data-svelte-h":!0}),le(e)!=="svelte-vwqboa"&&(e.textContent=t),this.h()},h(){v(e,"class","btn btn-outline btn-accent")},m(l,i){J(l,e,i),n||(r=x(e,"click",s[7]),n=!0)},p:ne,d(l){l&&O(e),n=!1,r()}}}function Ae(s){let e,t="Load",n,r;function l(){return s[15](s[21])}return{c(){e=N("button"),e.textContent=t,this.h()},l(i){e=L(i,"BUTTON",{class:!0,"data-svelte-h":!0}),le(e)!=="svelte-58jb7k"&&(e.textContent=t),this.h()},h(){v(e,"class","btn btn-link btn-sm p-0 no-underline text-accent")},m(i,c){J(i,e,c),n||(r=x(e,"click",l),n=!0)},p(i,c){s=i},d(i){i&&O(e),n=!1,r()}}}function Ve(s){let e,t,n,r,l,i,c,h,o=s[21].formattedDatetime+"",m,p,k=s[21].formattedSize+"",b,y,g,S,H,Z="Remove",B,w,$,P,W,_,E,I;t=new qe({props:{file:s[21],styleClass:"w-36"}});function U(...u){return s[14](s[21],...u)}let j=s[0]&&Ae(s);function fe(){return s[16](s[21])}function C(...u){return s[17](s[21],...u)}return{c(){e=N("li"),ae(t.$$.fragment),n=A(),r=N("div"),l=N("input"),c=A(),h=N("p"),m=ee(o),p=ee(" | "),b=ee(k),y=A(),g=N("div"),j&&j.c(),S=A(),H=N("button"),H.textContent=Z,B=A(),w=N("div"),$=N("textarea"),W=A(),this.h()},l(u){e=L(u,"LI",{class:!0});var a=Y(e);oe(t.$$.fragment,a),n=V(a),r=L(a,"DIV",{class:!0});var d=Y(r);l=L(d,"INPUT",{type:!0,class:!0}),c=V(d),h=L(d,"P",{class:!0});var f=Y(h);m=te(f,o),p=te(f," | "),b=te(f,k),f.forEach(O),y=V(d),g=L(d,"DIV",{});var T=Y(g);j&&j.l(T),S=V(T),H=L(T,"BUTTON",{class:!0,"data-svelte-h":!0}),le(H)!=="svelte-1mhg6fb"&&(H.textContent=Z),T.forEach(O),d.forEach(O),B=V(a),w=L(a,"DIV",{});var M=Y(w);$=L(M,"TEXTAREA",{name:!0,cols:!0,rows:!0,placeholder:!0,class:!0}),Y($).forEach(O),M.forEach(O),W=V(a),a.forEach(O),this.h()},h(){v(l,"type","text"),v(l,"class","input-bordered font-bold w-full bg-base-100"),l.value=i=s[21].name,v(h,"class","text-gray-500"),v(H,"class","btn btn-link btn-sm p-0 no-underline text-error"),v(r,"class","space-y-2 w-72"),v($,"name","notes"),v($,"cols","40"),v($,"rows","4"),v($,"placeholder","write some memos..."),v($,"class","resize-none textarea"),$.value=P=s[21].notes,v(e,"class","flex h-36 border-0 space-x-4 bg-base-100")},m(u,a){J(u,e,a),ce(t,e,null),D(e,n),D(e,r),D(r,l),D(r,c),D(r,h),D(h,m),D(h,p),D(h,b),D(r,y),D(r,g),j&&j.m(g,null),D(g,S),D(g,H),D(e,B),D(e,w),D(w,$),D(e,W),_=!0,E||(I=[x(l,"blur",U),x(H,"click",fe),x($,"blur",C)],E=!0)},p(u,a){s=u;const d={};a&18&&(d.file=s[21]),t.$set(d),(!_||a&18&&i!==(i=s[21].name)&&l.value!==i)&&(l.value=i),(!_||a&18)&&o!==(o=s[21].formattedDatetime+"")&&de(m,o),(!_||a&18)&&k!==(k=s[21].formattedSize+"")&&de(b,k),s[0]?j?j.p(s,a):(j=Ae(s),j.c(),j.m(g,S)):j&&(j.d(1),j=null),(!_||a&18&&P!==(P=s[21].notes))&&($.value=P)},i(u){_||(R(t.$$.fragment,u),_=!0)},o(u){K(t.$$.fragment,u),_=!1},d(u){u&&O(e),ue(t),j&&j.d(),E=!1,ke(I)}}}function ut(s){var B;let e,t,n,r,l,i="Sync",c,h,o,m,p,k,b,y=s[3]!=((B=s[2])==null?void 0:B.git_repo)&&Ye(s),g=$e(s[1].slice(0,s[4])),S=[];for(let w=0;w<g.length;w+=1)S[w]=Ve(He(s,g,w));const H=w=>K(S[w],1,1,()=>{S[w]=null});let Z={};return m=new Re({props:Z}),s[18](m),{c(){e=N("div"),t=N("input"),n=A(),y&&y.c(),r=A(),l=N("button"),l.textContent=i,c=A(),h=N("ul");for(let w=0;w<S.length;w+=1)S[w].c();o=A(),ae(m.$$.fragment),this.h()},l(w){e=L(w,"DIV",{});var $=Y(e);t=L($,"INPUT",{type:!0,placeholder:!0,class:!0}),n=V($),y&&y.l($),r=V($),l=L($,"BUTTON",{class:!0,"data-svelte-h":!0}),le(l)!=="svelte-118xeor"&&(l.textContent=i),$.forEach(O),c=V(w),h=L(w,"UL",{class:!0});var P=Y(h);for(let W=0;W<S.length;W+=1)S[W].l(P);P.forEach(O),o=V(w),oe(m.$$.fragment,w),this.h()},h(){v(t,"type","text"),v(t,"placeholder","Input your git repository address"),v(t,"class","input input-bordered w-full max-w-lg"),v(l,"class","btn btn-outline btn-accent"),v(h,"class","space-y-2 bg-base-300")},m(w,$){J(w,e,$),D(e,t),Oe(t,s[3]),D(e,n),y&&y.m(e,null),D(e,r),D(e,l),J(w,c,$),J(w,h,$);for(let P=0;P<S.length;P+=1)S[P]&&S[P].m(h,null);J(w,o,$),ce(m,w,$),p=!0,k||(b=[x(t,"input",s[13]),x(l,"click",s[6])],k=!0)},p(w,[$]){var W;if($&8&&t.value!==w[3]&&Oe(t,w[3]),w[3]!=((W=w[2])==null?void 0:W.git_repo)?y?y.p(w,$):(y=Ye(w),y.c(),y.m(e,r)):y&&(y.d(1),y=null),$&3859){g=$e(w[1].slice(0,w[4]));let _;for(_=0;_<g.length;_+=1){const E=He(w,g,_);S[_]?(S[_].p(E,$),R(S[_],1)):(S[_]=Ve(E),S[_].c(),R(S[_],1),S[_].m(h,null))}for(Te(),_=g.length;_<S.length;_+=1)H(_);De()}const P={};m.$set(P)},i(w){if(!p){for(let $=0;$<g.length;$+=1)R(S[$]);R(m.$$.fragment,w),p=!0}},o(w){S=S.filter(Boolean);for(let $=0;$<S.length;$+=1)K(S[$]);K(m.$$.fragment,w),p=!1},d(w){w&&(O(e),O(c),O(h),O(o)),y&&y.d(),ze(S,w),s[18](null),ue(m,w),k=!1,ke(b)}}}function ft(s,e,t){let{comfyUrl:n}=e,r,l=[],i={},c="",h=20,o;Be(async()=>{t(0,r=window.top.comfyApp),t(1,l=await Se("collections",n)),t(2,i=await m()||{}),t(3,c=i==null?void 0:i.git_repo),window.addEventListener("scroll",()=>{t(4,h=We(h,l.length))})});async function m(){return await(await fetch(n+"/browser/config")).json()}async function p(_){const E=_.target;E.disabled=!0,E.innerHTML="Syncing...";const I=await fetch(n+"/browser/collections/sync",{method:"POST"});o.show(I.ok,"Synced","Failed to sync. Please check the ComfyUI server."),E.disabled=!1,E.innerHTML="Sync",t(1,l=await Se("collections",n))}async function k(){const _=await fetch(n+"/browser/config",{method:"PUT",body:JSON.stringify({git_repo:c})});o.show(_.ok,"Updated config","Failed to update config. Please check the ComfyUI server.")}async function b(_){const E=await fetch(_.url),I=await E.blob(),U=new File([I],_.name,{type:E.headers.get("Content-Type")||""});await r.handleFile(U)}async function y(_){if(!confirm("You will delete this file? "+_.name))return;const I=await fetch(n+"/browser/files",{method:"DELETE",body:JSON.stringify({type:"collections",filename:_.name,folder_path:_.folder_path})});o.show(I.ok,"Deleted the file "+_.name,"Failed to delete the file. Please check the ComfyUI server."),t(1,l=l.filter(U=>U!=_))}async function g(_,E){return(await fetch(n+"/browser/collections/"+_.name,{method:"PUT",body:JSON.stringify(E)})).ok}async function S(_,E){const I=_.target.value;if(I===E.name)return;const U=await g(E,{filename:I,notes:E.notes||"",folder_path:E.folder_path});o.show(U,"Updated","Failed to update. Please check the ComfyUI server.")}async function H(_,E){const I=_.target.value;if(I==E.notes)return;const U=await g(E,{filename:E.name,notes:I,folder_path:E.folder_path});o.show(U,"Updated","Failed to update. Please check the ComfyUI server.")}function Z(){c=this.value,t(3,c)}const B=(_,E)=>S(E,_),w=async _=>await b(_),$=async _=>await y(_),P=(_,E)=>H(E,_);function W(_){Ce[_?"unshift":"push"](()=>{o=_,t(5,o)})}return s.$$set=_=>{"comfyUrl"in _&&t(12,n=_.comfyUrl)},[r,l,i,c,h,o,p,k,b,y,S,H,n,Z,B,w,$,P,W]}class ht extends pe{constructor(e){super(),be(this,e,ft,ut,_e,{comfyUrl:12})}}function dt(s){let e,t;return e=new ct({props:{comfyUrl:s[1]}}),{c(){ae(e.$$.fragment)},l(n){oe(e.$$.fragment,n)},m(n,r){ce(e,n,r),t=!0},p:ne,i(n){t||(R(e.$$.fragment,n),t=!0)},o(n){K(e.$$.fragment,n),t=!1},d(n){ue(e,n)}}}function mt(s){let e,t;return e=new ht({props:{comfyUrl:s[1]}}),{c(){ae(e.$$.fragment)},l(n){oe(e.$$.fragment,n)},m(n,r){ce(e,n,r),t=!0},p:ne,i(n){t||(R(e.$$.fragment,n),t=!0)},o(n){K(e.$$.fragment,n),t=!1},d(n){ue(e,n)}}}function _t(s){let e,t,n,r,l,i,c;function h(b){s[3](b)}let o={};s[0]!==void 0&&(o.activeTab=s[0]),e=new Xe({props:o}),Ce.push(()=>Ge(e,"activeTab",h));const m=[mt,dt],p=[];function k(b,y){return b[0]==="collections"?0:1}return r=k(s),l=p[r]=m[r](s),{c(){ae(e.$$.fragment),n=A(),l.c(),i=me()},l(b){oe(e.$$.fragment,b),n=V(b),l.l(b),i=me()},m(b,y){ce(e,b,y),J(b,n,y),p[r].m(b,y),J(b,i,y),c=!0},p(b,[y]){const g={};!t&&y&1&&(t=!0,g.activeTab=b[0],Ze(()=>t=!1)),e.$set(g);let S=r;r=k(b),r===S?p[r].p(b,y):(Te(),K(p[S],1,1,()=>{p[S]=null}),De(),l=p[r],l?l.p(b,y):(l=p[r]=m[r](b),l.c()),R(l,1),l.m(i.parentNode,i))},i(b){c||(R(e.$$.fragment,b),R(l),c=!0)},o(b){K(e.$$.fragment,b),K(l),c=!1},d(b){b&&(O(n),O(i)),ue(e,b),p[r].d(b)}}}function pt(s,e,t){let{data:n}=e;const{comfyUrl:r}=n;let l="outputs";function i(c){l=c,t(0,l)}return s.$$set=c=>{"data"in c&&t(2,n=c.data)},[l,r,n,i]}class gt extends pe{constructor(e){super(),be(this,e,pt,_t,_e,{data:2})}}export{gt as component};
