import{s as me,n as se,r as De,f as ye,o as Ye,b as We,h as Je}from"../chunks/scheduler.89bf212d.js";import{S as _e,i as pe,g as U,m as x,s as V,h as I,j as A,n as ee,f as T,c as z,k as g,a as W,x as k,y as te,l as Se,e as de,o as he,r as ae,u as oe,v as ie,d as B,p as Te,b as $e,t as G,z as Ae,w as ce,A as ve,B as Ze}from"../chunks/index.2f508abb.js";function ke(r){return(r==null?void 0:r.length)!==void 0?r:Array.from(r)}function qe(r){let e,t,l,a,s,n,f,o,c,_;return{c(){e=U("div"),t=U("button"),l=x("Outputs"),s=V(),n=U("button"),f=x("Collections"),this.h()},l(h){e=I(h,"DIV",{role:!0,class:!0});var D=A(e);t=I(D,"BUTTON",{role:!0,class:!0});var p=A(t);l=ee(p,"Outputs"),p.forEach(T),s=z(D),n=I(D,"BUTTON",{role:!0,class:!0});var M=A(n);f=ee(M,"Collections"),M.forEach(T),D.forEach(T),this.h()},h(){g(t,"role","tab"),g(t,"class",a="tab "+r[0]("outputs")),g(n,"role","tab"),g(n,"class",o="tab "+r[0]("collections")),g(e,"role","tablist"),g(e,"class","tabs tabs-boxed sticky top-0")},m(h,D){W(h,e,D),k(e,t),k(t,l),k(e,s),k(e,n),k(n,f),c||(_=[te(t,"click",r[3]),te(n,"click",r[4])],c=!0)},p(h,[D]){D&1&&a!==(a="tab "+h[0]("outputs"))&&g(t,"class",a),D&1&&o!==(o="tab "+h[0]("collections"))&&g(n,"class",o)},i:se,o:se,d(h){h&&T(e),c=!1,De(_)}}}function Re(r,e,t){let l,{activeTab:a="outputs"}=e;function s(o){t(2,a=o)}const n=()=>s("outputs"),f=()=>s("collections");return r.$$set=o=>{"activeTab"in o&&t(2,a=o.activeTab)},r.$$.update=()=>{r.$$.dirty&4&&t(0,l=function(o){return o===a?"tab-active":""})},[l,s,a,n,f]}class Ge extends _e{constructor(e){super(),pe(this,e,Re,qe,me,{activeTab:2})}}var Ke=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Qe(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var Pe={exports:{}};(function(r,e){(function(t,l){r.exports=l()})(Ke,function(){var t=1e3,l=6e4,a=36e5,s="millisecond",n="second",f="minute",o="hour",c="day",_="week",h="month",D="quarter",p="year",M="date",Y="Invalid Date",S=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,j=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,R={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(v){var u=["th","st","nd","rd"],i=v%100;return"["+v+(u[(i-20)%10]||u[i]||u[0])+"]"}},y=function(v,u,i){var m=String(v);return!m||m.length>=u?v:""+Array(u+1-m.length).join(i)+v},L={s:y,z:function(v){var u=-v.utcOffset(),i=Math.abs(u),m=Math.floor(i/60),d=i%60;return(u<=0?"+":"-")+y(m,2,"0")+":"+y(d,2,"0")},m:function v(u,i){if(u.date()<i.date())return-v(i,u);var m=12*(i.year()-u.year())+(i.month()-u.month()),d=u.clone().add(m,h),b=i-d<0,w=u.clone().add(m+(b?-1:1),h);return+(-(m+(i-d)/(b?d-w:w-d))||0)},a:function(v){return v<0?Math.ceil(v)||0:Math.floor(v)},p:function(v){return{M:h,y:p,w:_,d:c,D:M,h:o,m:f,s:n,ms:s,Q:D}[v]||String(v||"").toLowerCase().replace(/s$/,"")},u:function(v){return v===void 0}},C="en",N={};N[C]=R;var X="$isDayjsObject",J=function(v){return v instanceof $||!(!v||!v[X])},Z=function v(u,i,m){var d;if(!u)return C;if(typeof u=="string"){var b=u.toLowerCase();N[b]&&(d=b),i&&(N[b]=i,d=b);var w=u.split("-");if(!d&&w.length>1)return v(w[0])}else{var E=u.name;N[E]=u,d=E}return!m&&d&&(C=d),d||!m&&C},F=function(v,u){if(J(v))return v.clone();var i=typeof u=="object"?u:{};return i.date=v,i.args=arguments,new $(i)},O=L;O.l=Z,O.i=J,O.w=function(v,u){return F(v,{locale:u.$L,utc:u.$u,x:u.$x,$offset:u.$offset})};var $=function(){function v(i){this.$L=Z(i.locale,null,!0),this.parse(i),this.$x=this.$x||i.x||{},this[X]=!0}var u=v.prototype;return u.parse=function(i){this.$d=function(m){var d=m.date,b=m.utc;if(d===null)return new Date(NaN);if(O.u(d))return new Date;if(d instanceof Date)return new Date(d);if(typeof d=="string"&&!/Z$/i.test(d)){var w=d.match(S);if(w){var E=w[2]-1||0,P=(w[7]||"0").substring(0,3);return b?new Date(Date.UTC(w[1],E,w[3]||1,w[4]||0,w[5]||0,w[6]||0,P)):new Date(w[1],E,w[3]||1,w[4]||0,w[5]||0,w[6]||0,P)}}return new Date(d)}(i),this.init()},u.init=function(){var i=this.$d;this.$y=i.getFullYear(),this.$M=i.getMonth(),this.$D=i.getDate(),this.$W=i.getDay(),this.$H=i.getHours(),this.$m=i.getMinutes(),this.$s=i.getSeconds(),this.$ms=i.getMilliseconds()},u.$utils=function(){return O},u.isValid=function(){return this.$d.toString()!==Y},u.isSame=function(i,m){var d=F(i);return this.startOf(m)<=d&&d<=this.endOf(m)},u.isAfter=function(i,m){return F(i)<this.startOf(m)},u.isBefore=function(i,m){return this.endOf(m)<F(i)},u.$g=function(i,m,d){return O.u(i)?this[m]:this.set(d,i)},u.unix=function(){return Math.floor(this.valueOf()/1e3)},u.valueOf=function(){return this.$d.getTime()},u.startOf=function(i,m){var d=this,b=!!O.u(m)||m,w=O.p(i),E=function(le,K){var ne=O.w(d.$u?Date.UTC(d.$y,K,le):new Date(d.$y,K,le),d);return b?ne:ne.endOf(c)},P=function(le,K){return O.w(d.toDate()[le].apply(d.toDate("s"),(b?[0,0,0,0]:[23,59,59,999]).slice(K)),d)},H=this.$W,q=this.$M,Q=this.$D,fe="set"+(this.$u?"UTC":"");switch(w){case p:return b?E(1,0):E(31,11);case h:return b?E(1,q):E(0,q+1);case _:var re=this.$locale().weekStart||0,be=(H<re?H+7:H)-re;return E(b?Q-be:Q+(6-be),q);case c:case M:return P(fe+"Hours",0);case o:return P(fe+"Minutes",1);case f:return P(fe+"Seconds",2);case n:return P(fe+"Milliseconds",3);default:return this.clone()}},u.endOf=function(i){return this.startOf(i,!1)},u.$set=function(i,m){var d,b=O.p(i),w="set"+(this.$u?"UTC":""),E=(d={},d[c]=w+"Date",d[M]=w+"Date",d[h]=w+"Month",d[p]=w+"FullYear",d[o]=w+"Hours",d[f]=w+"Minutes",d[n]=w+"Seconds",d[s]=w+"Milliseconds",d)[b],P=b===c?this.$D+(m-this.$W):m;if(b===h||b===p){var H=this.clone().set(M,1);H.$d[E](P),H.init(),this.$d=H.set(M,Math.min(this.$D,H.daysInMonth())).$d}else E&&this.$d[E](P);return this.init(),this},u.set=function(i,m){return this.clone().$set(i,m)},u.get=function(i){return this[O.p(i)]()},u.add=function(i,m){var d,b=this;i=Number(i);var w=O.p(m),E=function(q){var Q=F(b);return O.w(Q.date(Q.date()+Math.round(q*i)),b)};if(w===h)return this.set(h,this.$M+i);if(w===p)return this.set(p,this.$y+i);if(w===c)return E(1);if(w===_)return E(7);var P=(d={},d[f]=l,d[o]=a,d[n]=t,d)[w]||1,H=this.$d.getTime()+i*P;return O.w(H,this)},u.subtract=function(i,m){return this.add(-1*i,m)},u.format=function(i){var m=this,d=this.$locale();if(!this.isValid())return d.invalidDate||Y;var b=i||"YYYY-MM-DDTHH:mm:ssZ",w=O.z(this),E=this.$H,P=this.$m,H=this.$M,q=d.weekdays,Q=d.months,fe=d.meridiem,re=function(K,ne,ge,we){return K&&(K[ne]||K(m,b))||ge[ne].slice(0,we)},be=function(K){return O.s(E%12||12,K,"0")},le=fe||function(K,ne,ge){var we=K<12?"AM":"PM";return ge?we.toLowerCase():we};return b.replace(j,function(K,ne){return ne||function(ge){switch(ge){case"YY":return String(m.$y).slice(-2);case"YYYY":return O.s(m.$y,4,"0");case"M":return H+1;case"MM":return O.s(H+1,2,"0");case"MMM":return re(d.monthsShort,H,Q,3);case"MMMM":return re(Q,H);case"D":return m.$D;case"DD":return O.s(m.$D,2,"0");case"d":return String(m.$W);case"dd":return re(d.weekdaysMin,m.$W,q,2);case"ddd":return re(d.weekdaysShort,m.$W,q,3);case"dddd":return q[m.$W];case"H":return String(E);case"HH":return O.s(E,2,"0");case"h":return be(1);case"hh":return be(2);case"a":return le(E,P,!0);case"A":return le(E,P,!1);case"m":return String(P);case"mm":return O.s(P,2,"0");case"s":return String(m.$s);case"ss":return O.s(m.$s,2,"0");case"SSS":return O.s(m.$ms,3,"0");case"Z":return w}return null}(K)||w.replace(":","")})},u.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},u.diff=function(i,m,d){var b,w=this,E=O.p(m),P=F(i),H=(P.utcOffset()-this.utcOffset())*l,q=this-P,Q=function(){return O.m(w,P)};switch(E){case p:b=Q()/12;break;case h:b=Q();break;case D:b=Q()/3;break;case _:b=(q-H)/6048e5;break;case c:b=(q-H)/864e5;break;case o:b=q/a;break;case f:b=q/l;break;case n:b=q/t;break;default:b=q}return d?b:O.a(b)},u.daysInMonth=function(){return this.endOf(h).$D},u.$locale=function(){return N[this.$L]},u.locale=function(i,m){if(!i)return this.$L;var d=this.clone(),b=Z(i,m,!0);return b&&(d.$L=b),d},u.clone=function(){return O.w(this.$d,this)},u.toDate=function(){return new Date(this.valueOf())},u.toJSON=function(){return this.isValid()?this.toISOString():null},u.toISOString=function(){return this.$d.toISOString()},u.toString=function(){return this.$d.toUTCString()},v}(),ue=$.prototype;return F.prototype=ue,[["$ms",s],["$s",n],["$m",f],["$H",o],["$W",c],["$M",h],["$y",p],["$D",M]].forEach(function(v){ue[v[1]]=function(u){return this.$g(u,v[0],v[1])}}),F.extend=function(v,u){return v.$i||(v(u,$,F),v.$i=!0),F},F.locale=Z,F.isDayjs=J,F.unix=function(v){return F(1e3*v)},F.en=N[C],F.Ls=N,F.p={},F})})(Pe);var Xe=Pe.exports;const xe=Qe(Xe);async function He(r,e){let a=(await(await fetch(e+"/browser/"+r)).json()).files;return a.forEach(s=>{const n=s.name.split(".").pop().toLowerCase();s.fileType="unknown",["png","webp","jpeg","jpg","gif"].includes(n)&&(s.fileType="image"),["mp4","webm","mov","avi","mkv"].includes(n)&&(s.fileType="video"),r==="collections"?s.url=`${e}/browser/collections/view?filename=${s.name}`:s.url=`${e}/view?filename=${s.name}`;const f=xe.unix(s.created_at);s.formattedDatetime=f.format("YYYY-MM-DD HH-mm-ss"),s.bytes/1024/1024>1?s.formattedSize=(s.bytes/1024/1024).toFixed(2)+" MB":s.formattedSize=Math.round(s.bytes/1024)+" KB"}),a}function Ve(r,e){if(r>=e)return r;const t=document.documentElement.scrollHeight;return window.innerHeight+window.scrollY>=t?r+10:r}function Me(r){let e,t,l;return{c(){e=U("img"),this.h()},l(a){e=I(a,"IMG",{class:!0,loading:!0,src:!0,alt:!0}),this.h()},h(){g(e,"class","h-full w-full object-contain"),g(e,"loading","lazy"),ye(e.src,t=r[0].url)||g(e,"src",t),g(e,"alt",l=r[0].name)},m(a,s){W(a,e,s)},p(a,s){s&1&&!ye(e.src,t=a[0].url)&&g(e,"src",t),s&1&&l!==(l=a[0].name)&&g(e,"alt",l)},d(a){a&&T(e)}}}function Ce(r){let e,t,l;return{c(){e=U("video"),t=U("track"),this.h()},l(a){e=I(a,"VIDEO",{class:!0,src:!0});var s=A(e);t=I(s,"TRACK",{kind:!0}),s.forEach(T),this.h()},h(){g(t,"kind","captions"),g(e,"class","h-full w-full object-contain pb-0.5 border-0.5 border-black"),ye(e.src,l=r[0].url)||g(e,"src",l),e.loop=!0,e.autoplay=!0,e.muted=!0},m(a,s){W(a,e,s),k(e,t)},p(a,s){s&1&&!ye(e.src,l=a[0].url)&&g(e,"src",l)},d(a){a&&T(e)}}}function et(r){let e,t,l,a,s=r[0].fileType==="image"&&Me(r),n=r[0].fileType==="video"&&Ce(r);return{c(){e=U("div"),t=U("a"),s&&s.c(),l=V(),n&&n.c(),this.h()},l(f){e=I(f,"DIV",{class:!0});var o=A(e);t=I(o,"A",{href:!0,target:!0,style:!0});var c=A(t);s&&s.l(c),l=z(c),n&&n.l(c),c.forEach(T),o.forEach(T),this.h()},h(){g(t,"href",a=r[0].url),g(t,"target","_blank"),Se(t,"height","inherit"),Se(t,"width","inherit"),g(e,"class",r[1])},m(f,o){W(f,e,o),k(e,t),s&&s.m(t,null),k(t,l),n&&n.m(t,null)},p(f,[o]){f[0].fileType==="image"?s?s.p(f,o):(s=Me(f),s.c(),s.m(t,l)):s&&(s.d(1),s=null),f[0].fileType==="video"?n?n.p(f,o):(n=Ce(f),n.c(),n.m(t,null)):n&&(n.d(1),n=null),o&1&&a!==(a=f[0].url)&&g(t,"href",a),o&2&&g(e,"class",f[1])},i:se,o:se,d(f){f&&T(e),s&&s.d(),n&&n.d()}}}function tt(r,e,t){let{file:l}=e,{styleClass:a}=e;return r.$$set=s=>{"file"in s&&t(0,l=s.file),"styleClass"in s&&t(1,a=s.styleClass)},[l,a]}class ze extends _e{constructor(e){super(),pe(this,e,tt,et,me,{file:0,styleClass:1})}}function Oe(r){let e,t,l,a,s;return{c(){e=U("div"),t=U("div"),l=U("span"),a=x(r[2]),this.h()},l(n){e=I(n,"DIV",{class:!0});var f=A(e);t=I(f,"DIV",{class:!0});var o=A(t);l=I(o,"SPAN",{});var c=A(l);a=ee(c,r[2]),c.forEach(T),o.forEach(T),f.forEach(T),this.h()},h(){g(t,"class",s="alert "+(r[1]?"alert-success":"alert-error")),g(e,"class","toast toast-center")},m(n,f){W(n,e,f),k(e,t),k(t,l),k(l,a)},p(n,f){f&4&&he(a,n[2]),f&2&&s!==(s="alert "+(n[1]?"alert-success":"alert-error"))&&g(t,"class",s)},d(n){n&&T(e)}}}function nt(r){let e,t=r[0]&&Oe(r);return{c(){t&&t.c(),e=de()},l(l){t&&t.l(l),e=de()},m(l,a){t&&t.m(l,a),W(l,e,a)},p(l,[a]){l[0]?t?t.p(l,a):(t=Oe(l),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},i:se,o:se,d(l){l&&T(e),t&&t.d(l)}}}function st(r,e,t){let{showToast:l=!1}=e,{toastSuccess:a=!0}=e,{toastText:s=""}=e;return r.$$set=n=>{"showToast"in n&&t(0,l=n.showToast),"toastSuccess"in n&&t(1,a=n.toastSuccess),"toastText"in n&&t(2,s=n.toastText)},[l,a,s]}class Be extends _e{constructor(e){super(),pe(this,e,st,nt,me,{showToast:0,toastSuccess:1,toastText:2})}}function Ee(r,e,t){const l=r.slice();return l[13]=e[t],l}function Ue(r){let e,t,l,a,s,n=r[13].name+"",f,o,c,_=r[13].formattedDatetime+"",h,D,p,M=r[13].formattedSize+"",Y,S,j,R,y,L="Collect",C,N,X="Delete",J,Z,F,O;l=new ze({props:{file:r[13],styleClass:"w-full h-36"}});let $=r[0]&&Ie(r);function ue(){return r[11](r[13])}function v(){return r[12](r[13])}return{c(){e=U("div"),t=U("div"),ae(l.$$.fragment),a=V(),s=U("p"),f=x(n),o=V(),c=U("p"),h=x(_),D=V(),p=U("p"),Y=x(M),S=V(),j=U("div"),$&&$.c(),R=V(),y=U("button"),y.textContent=L,C=V(),N=U("button"),N.textContent=X,J=V(),this.h()},l(u){e=I(u,"DIV",{class:!0});var i=A(e);t=I(i,"DIV",{class:!0});var m=A(t);oe(l.$$.fragment,m),m.forEach(T),a=z(i),s=I(i,"P",{class:!0});var d=A(s);f=ee(d,n),d.forEach(T),o=z(i),c=I(i,"P",{class:!0});var b=A(c);h=ee(b,_),b.forEach(T),D=z(i),p=I(i,"P",{class:!0});var w=A(p);Y=ee(w,M),w.forEach(T),S=z(i),j=I(i,"DIV",{class:!0});var E=A(j);$&&$.l(E),R=z(E),y=I(E,"BUTTON",{class:!0,"data-svelte-h":!0}),ve(y)!=="svelte-jct3zc"&&(y.textContent=L),C=z(E),N=I(E,"BUTTON",{class:!0,"data-svelte-h":!0}),ve(N)!=="svelte-1t0nfha"&&(N.textContent=X),E.forEach(T),J=z(i),i.forEach(T),this.h()},h(){g(t,"class","flex items-center"),g(s,"class","font-bold max-h-12 leading-6 overflow-auto"),g(c,"class","text-gray-500"),g(p,"class","text-gray-500"),g(y,"class","btn btn-link btn-sm p-0 no-underline text-accent"),g(N,"class","btn btn-link btn-sm p-0 no-underline text-error"),g(j,"class",""),g(e,"class","bg-base-100")},m(u,i){W(u,e,i),k(e,t),ie(l,t,null),k(e,a),k(e,s),k(s,f),k(e,o),k(e,c),k(c,h),k(e,D),k(e,p),k(p,Y),k(e,S),k(e,j),$&&$.m(j,null),k(j,R),k(j,y),k(j,C),k(j,N),k(e,J),Z=!0,F||(O=[te(y,"click",ue),te(N,"click",v)],F=!0)},p(u,i){r=u;const m={};i&6&&(m.file=r[13]),l.$set(m),(!Z||i&6)&&n!==(n=r[13].name+"")&&he(f,n),(!Z||i&6)&&_!==(_=r[13].formattedDatetime+"")&&he(h,_),(!Z||i&6)&&M!==(M=r[13].formattedSize+"")&&he(Y,M),r[0]?$?$.p(r,i):($=Ie(r),$.c(),$.m(j,R)):$&&($.d(1),$=null)},i(u){Z||(B(l.$$.fragment,u),Z=!0)},o(u){G(l.$$.fragment,u),Z=!1},d(u){u&&T(e),ce(l),$&&$.d(),F=!1,De(O)}}}function Ie(r){let e,t="Load",l,a;function s(){return r[10](r[13])}return{c(){e=U("button"),e.textContent=t,this.h()},l(n){e=I(n,"BUTTON",{class:!0,"data-svelte-h":!0}),ve(e)!=="svelte-58jb7k"&&(e.textContent=t),this.h()},h(){g(e,"class","btn btn-link btn-sm p-0 no-underline text-accent")},m(n,f){W(n,e,f),l||(a=te(e,"click",s),l=!0)},p(n,f){r=n},d(n){n&&T(e),l=!1,a()}}}function je(r){let e=["image","video"].includes(r[13].fileType),t,l,a=e&&Ue(r);return{c(){a&&a.c(),t=de()},l(s){a&&a.l(s),t=de()},m(s,n){a&&a.m(s,n),W(s,t,n),l=!0},p(s,n){n&6&&(e=["image","video"].includes(s[13].fileType)),e?a?(a.p(s,n),n&6&&B(a,1)):(a=Ue(s),a.c(),B(a,1),a.m(t.parentNode,t)):a&&(Te(),G(a,1,1,()=>{a=null}),$e())},i(s){l||(B(a),l=!0)},o(s){G(a),l=!1},d(s){s&&T(t),a&&a.d(s)}}}function rt(r){let e,t,l,a,s=ke(r[1].slice(0,r[2])),n=[];for(let o=0;o<s.length;o+=1)n[o]=je(Ee(r,s,o));const f=o=>G(n[o],1,1,()=>{n[o]=null});return l=new Be({props:{showToast:r[3],toastSuccess:r[4],toastText:r[5]}}),{c(){e=U("div");for(let o=0;o<n.length;o+=1)n[o].c();t=V(),ae(l.$$.fragment),this.h()},l(o){e=I(o,"DIV",{class:!0});var c=A(e);for(let _=0;_<n.length;_+=1)n[_].l(c);c.forEach(T),t=z(o),oe(l.$$.fragment,o),this.h()},h(){g(e,"class","grid grid-cols-4 lg:grid-cols-6 gap-2 bg-base-300")},m(o,c){W(o,e,c);for(let _=0;_<n.length;_+=1)n[_]&&n[_].m(e,null);W(o,t,c),ie(l,o,c),a=!0},p(o,[c]){if(c&455){s=ke(o[1].slice(0,o[2]));let h;for(h=0;h<s.length;h+=1){const D=Ee(o,s,h);n[h]?(n[h].p(D,c),B(n[h],1)):(n[h]=je(D),n[h].c(),B(n[h],1),n[h].m(e,null))}for(Te(),h=s.length;h<n.length;h+=1)f(h);$e()}const _={};c&8&&(_.showToast=o[3]),c&16&&(_.toastSuccess=o[4]),c&32&&(_.toastText=o[5]),l.$set(_)},i(o){if(!a){for(let c=0;c<s.length;c+=1)B(n[c]);B(l.$$.fragment,o),a=!0}},o(o){n=n.filter(Boolean);for(let c=0;c<n.length;c+=1)G(n[c]);G(l.$$.fragment,o),a=!1},d(o){o&&(T(e),T(t)),Ae(n,o),ce(l,o)}}}function lt(r,e,t){let{comfyUrl:l}=e,a,s=[],n=20,f=!1,o=!0,c="";Ye(async()=>{t(0,a=window.top.comfyApp),t(1,s=await He("files",l)),window.addEventListener("scroll",()=>{t(2,n=Ve(n,s.length))})});async function _(S){const j=await fetch(S.url),R=await j.blob(),y=new File([R],S.name,{type:j.headers.get("Content-Type")||""});await a.handleFile(y)}async function h(S){const j=await fetch(l+"/browser/collections",{method:"POST",body:JSON.stringify({filename:S.name,folder_path:S.folder_path})});t(4,o=j.ok),o?t(5,c="Added to collections"):t(5,c="Failed to add to collections. Please check the ComfyUI server."),t(3,f=!0),setTimeout(()=>t(3,f=!1),2e3)}async function D(S){if(!confirm("You will delete this file? "+S.name))return;const R=await fetch(l+"/browser/files",{method:"DELETE",body:JSON.stringify({type:"files",filename:S.name,folder_path:S.folder_path})});t(4,o=R.ok),o?t(5,c="Deleted the file "+S.name):t(5,c="Failed to delete the file. Please check the ComfyUI server."),t(3,f=!0),setTimeout(()=>t(3,f=!1),2e3),t(1,s=s.filter(y=>y!=S))}const p=async S=>await _(S),M=async S=>await h(S),Y=async S=>await D(S);return r.$$set=S=>{"comfyUrl"in S&&t(9,l=S.comfyUrl)},[a,s,n,f,o,c,_,h,D,l,p,M,Y]}class at extends _e{constructor(e){super(),pe(this,e,lt,rt,me,{comfyUrl:9})}}function Le(r,e,t){const l=r.slice();return l[16]=e[t],l}function Ne(r){let e,t="Load",l,a;function s(){return r[12](r[16])}return{c(){e=U("button"),e.textContent=t,this.h()},l(n){e=I(n,"BUTTON",{class:!0,"data-svelte-h":!0}),ve(e)!=="svelte-58jb7k"&&(e.textContent=t),this.h()},h(){g(e,"class","btn btn-link btn-sm p-0 no-underline text-accent")},m(n,f){W(n,e,f),l||(a=te(e,"click",s),l=!0)},p(n,f){r=n},d(n){n&&T(e),l=!1,a()}}}function Fe(r){let e,t,l,a,s,n,f,o,c=r[16].formattedDatetime+"",_,h,D=r[16].formattedSize+"",p,M,Y,S,j,R="Remove",y,L,C,N,X,J,Z,F;t=new ze({props:{file:r[16],styleClass:"w-36"}});function O(...u){return r[11](r[16],...u)}let $=r[0]&&Ne(r);function ue(){return r[13](r[16])}function v(...u){return r[14](r[16],...u)}return{c(){e=U("li"),ae(t.$$.fragment),l=V(),a=U("div"),s=U("input"),f=V(),o=U("p"),_=x(c),h=x(" | "),p=x(D),M=V(),Y=U("div"),$&&$.c(),S=V(),j=U("button"),j.textContent=R,y=V(),L=U("div"),C=U("textarea"),X=V(),this.h()},l(u){e=I(u,"LI",{class:!0});var i=A(e);oe(t.$$.fragment,i),l=z(i),a=I(i,"DIV",{class:!0});var m=A(a);s=I(m,"INPUT",{type:!0,class:!0}),f=z(m),o=I(m,"P",{class:!0});var d=A(o);_=ee(d,c),h=ee(d," | "),p=ee(d,D),d.forEach(T),M=z(m),Y=I(m,"DIV",{});var b=A(Y);$&&$.l(b),S=z(b),j=I(b,"BUTTON",{class:!0,"data-svelte-h":!0}),ve(j)!=="svelte-1mhg6fb"&&(j.textContent=R),b.forEach(T),m.forEach(T),y=z(i),L=I(i,"DIV",{});var w=A(L);C=I(w,"TEXTAREA",{name:!0,cols:!0,rows:!0,placeholder:!0,class:!0}),A(C).forEach(T),w.forEach(T),X=z(i),i.forEach(T),this.h()},h(){g(s,"type","text"),g(s,"class","input-bordered font-bold w-full bg-base-100"),s.value=n=r[16].name,g(o,"class","text-gray-500"),g(j,"class","btn btn-link btn-sm p-0 no-underline text-error"),g(a,"class","space-y-2 w-72"),g(C,"name","notes"),g(C,"cols","40"),g(C,"rows","4"),g(C,"placeholder","write some memos..."),g(C,"class","resize-none textarea"),C.value=N=r[16].notes,g(e,"class","flex h-36 border-0 space-x-4 bg-base-100")},m(u,i){W(u,e,i),ie(t,e,null),k(e,l),k(e,a),k(a,s),k(a,f),k(a,o),k(o,_),k(o,h),k(o,p),k(a,M),k(a,Y),$&&$.m(Y,null),k(Y,S),k(Y,j),k(e,y),k(e,L),k(L,C),k(e,X),J=!0,Z||(F=[te(s,"blur",O),te(j,"click",ue),te(C,"blur",v)],Z=!0)},p(u,i){r=u;const m={};i&6&&(m.file=r[16]),t.$set(m),(!J||i&6&&n!==(n=r[16].name)&&s.value!==n)&&(s.value=n),(!J||i&6)&&c!==(c=r[16].formattedDatetime+"")&&he(_,c),(!J||i&6)&&D!==(D=r[16].formattedSize+"")&&he(p,D),r[0]?$?$.p(r,i):($=Ne(r),$.c(),$.m(Y,S)):$&&($.d(1),$=null),(!J||i&6&&N!==(N=r[16].notes))&&(C.value=N)},i(u){J||(B(t.$$.fragment,u),J=!0)},o(u){G(t.$$.fragment,u),J=!1},d(u){u&&T(e),ce(t),$&&$.d(),Z=!1,De(F)}}}function ot(r){let e,t,l,a,s=ke(r[1].slice(0,r[2])),n=[];for(let o=0;o<s.length;o+=1)n[o]=Fe(Le(r,s,o));const f=o=>G(n[o],1,1,()=>{n[o]=null});return l=new Be({props:{showToast:r[3],toastSuccess:r[4],toastText:r[5]}}),{c(){e=U("ul");for(let o=0;o<n.length;o+=1)n[o].c();t=V(),ae(l.$$.fragment),this.h()},l(o){e=I(o,"UL",{class:!0});var c=A(e);for(let _=0;_<n.length;_+=1)n[_].l(c);c.forEach(T),t=z(o),oe(l.$$.fragment,o),this.h()},h(){g(e,"class","space-y-2 bg-base-300")},m(o,c){W(o,e,c);for(let _=0;_<n.length;_+=1)n[_]&&n[_].m(e,null);W(o,t,c),ie(l,o,c),a=!0},p(o,[c]){if(c&967){s=ke(o[1].slice(0,o[2]));let h;for(h=0;h<s.length;h+=1){const D=Le(o,s,h);n[h]?(n[h].p(D,c),B(n[h],1)):(n[h]=Fe(D),n[h].c(),B(n[h],1),n[h].m(e,null))}for(Te(),h=s.length;h<n.length;h+=1)f(h);$e()}const _={};c&8&&(_.showToast=o[3]),c&16&&(_.toastSuccess=o[4]),c&32&&(_.toastText=o[5]),l.$set(_)},i(o){if(!a){for(let c=0;c<s.length;c+=1)B(n[c]);B(l.$$.fragment,o),a=!0}},o(o){n=n.filter(Boolean);for(let c=0;c<n.length;c+=1)G(n[c]);G(l.$$.fragment,o),a=!1},d(o){o&&(T(e),T(t)),Ae(n,o),ce(l,o)}}}function it(r,e,t){let{comfyUrl:l}=e,a,s=[],n=20,f=!1,o=!0,c="";Ye(async()=>{t(0,a=window.top.comfyApp),t(1,s=await He("collections",l)),window.addEventListener("scroll",()=>{t(2,n=Ve(n,s.length))})});async function _(y){const L=await fetch(y.url),C=await L.blob(),N=new File([C],y.name,{type:L.headers.get("Content-Type")||""});await a.handleFile(N)}async function h(y){if(!confirm("You will delete this file? "+y.name))return;const C=await fetch(l+"/browser/files",{method:"DELETE",body:JSON.stringify({type:"collections",filename:y.name,folder_path:y.folder_path})});t(4,o=C.ok),o?t(5,c="Deleted the file "+y.name):t(5,c="Failed to delete the file. Please check the ComfyUI server."),t(3,f=!0),setTimeout(()=>t(3,f=!1),2e3),t(1,s=s.filter(N=>N!=y))}async function D(y,L){return(await fetch(l+"/browser/collections/"+y.name,{method:"PUT",body:JSON.stringify(L)})).ok}async function p(y,L){const C=y.target.value;if(C===L.name)return;const N=await D(L,{filename:C,notes:L.notes||"",folder_path:L.folder_path});t(4,o=N),o?t(5,c="Updated"):t(5,c="Failed to Update. Please check the ComfyUI server."),t(3,f=!0),setTimeout(()=>t(3,f=!1),2e3)}async function M(y,L){const C=y.target.value;if(C==L.notes)return;const N=await D(L,{filename:L.name,notes:C,folder_path:L.folder_path});t(4,o=N),o?t(5,c="Updated"):t(5,c="Failed to Update. Please check the ComfyUI server."),t(3,f=!0),setTimeout(()=>t(3,f=!1),2e3)}const Y=(y,L)=>p(L,y),S=async y=>await _(y),j=async y=>await h(y),R=(y,L)=>M(L,y);return r.$$set=y=>{"comfyUrl"in y&&t(10,l=y.comfyUrl)},[a,s,n,f,o,c,_,h,p,M,l,Y,S,j,R]}class ct extends _e{constructor(e){super(),pe(this,e,it,ot,me,{comfyUrl:10})}}function ut(r){let e,t;return e=new at({props:{comfyUrl:r[1]}}),{c(){ae(e.$$.fragment)},l(l){oe(e.$$.fragment,l)},m(l,a){ie(e,l,a),t=!0},p:se,i(l){t||(B(e.$$.fragment,l),t=!0)},o(l){G(e.$$.fragment,l),t=!1},d(l){ce(e,l)}}}function ft(r){let e,t;return e=new ct({props:{comfyUrl:r[1]}}),{c(){ae(e.$$.fragment)},l(l){oe(e.$$.fragment,l)},m(l,a){ie(e,l,a),t=!0},p:se,i(l){t||(B(e.$$.fragment,l),t=!0)},o(l){G(e.$$.fragment,l),t=!1},d(l){ce(e,l)}}}function ht(r){let e,t,l,a,s,n,f;function o(p){r[3](p)}let c={};r[0]!==void 0&&(c.activeTab=r[0]),e=new Ge({props:c}),We.push(()=>Ze(e,"activeTab",o));const _=[ft,ut],h=[];function D(p,M){return p[0]==="collections"?0:1}return a=D(r),s=h[a]=_[a](r),{c(){ae(e.$$.fragment),l=V(),s.c(),n=de()},l(p){oe(e.$$.fragment,p),l=z(p),s.l(p),n=de()},m(p,M){ie(e,p,M),W(p,l,M),h[a].m(p,M),W(p,n,M),f=!0},p(p,[M]){const Y={};!t&&M&1&&(t=!0,Y.activeTab=p[0],Je(()=>t=!1)),e.$set(Y);let S=a;a=D(p),a===S?h[a].p(p,M):(Te(),G(h[S],1,1,()=>{h[S]=null}),$e(),s=h[a],s?s.p(p,M):(s=h[a]=_[a](p),s.c()),B(s,1),s.m(n.parentNode,n))},i(p){f||(B(e.$$.fragment,p),B(s),f=!0)},o(p){G(e.$$.fragment,p),G(s),f=!1},d(p){p&&(T(l),T(n)),ce(e,p),h[a].d(p)}}}function dt(r,e,t){let{data:l}=e;const{comfyUrl:a}=l;let s="outputs";function n(f){s=f,t(0,s)}return r.$$set=f=>{"data"in f&&t(2,l=f.data)},[s,a,l,n]}class pt extends _e{constructor(e){super(),pe(this,e,dt,ht,me,{data:2})}}export{pt as component};
